import{_ as Te}from"./table-header-operation.vue_vue_type_script_setup_true_lang-ntuddL0e.js";import{d as C,p as H,o as S,c as x,h as e,$ as a,Y as L,bo as ve,a3 as W,bp as ke,bq as je,br as Se,U as Z,V as oe,r as re,a as he,W as Ne,w as o,f as t,g as v,t as k,b as le,Q as ne,bs as ie,R as se,S as we,n as me,B as M,I as de,bt as xe,a4 as F,bu as ce,bv as Ie,bw as De,bn as Re,bx as ge,by as be,N as X,s as Ue,u as $e,a8 as Ve,a9 as G,aa as Ce}from"./index-DQvTTbM-.js";import{b as Oe,c as Ke,d as Je,e as Ae,g as Be,h as Fe}from"./job-UWaVutAa.js";import{b as Me,c as Pe,_ as ze,u as qe,a as Ee,N as ue}from"./table-BY-eM7wn.js";import{_ as Ge}from"./status-switch.vue_vue_type_script_setup_true_lang-BMqUMIex.js";import{u as He}from"./auth-Ncng77z3.js";import{_ as fe}from"./select-group.vue_vue_type_script_setup_true_lang-BFflBQVF.js";import{_ as Le,a as We}from"./route-key.vue_vue_type_script_setup_true_lang-CbxFEpse.js";import{u as Qe,a as Ye,_ as Xe,b as Ze}from"./form-Bu4MD_Ly.js";import{_ as ye}from"./operate-drawer-CZXJ_kn-.js";import{_ as pe}from"./code-mirror.vue_vue_type_script_setup_true_lang-Cgtmy6g2.js";import{_ as ea}from"./Space-B5Upi9VN.js";import{_ as aa,a as ta,b as la}from"./Grid-CSTnYjse.js";import{_ as oa}from"./search-form.vue_vue_type_script_setup_true_lang-gb65EZBS.js";import{_ as ra,a as na}from"./DescriptionsItem-Bd4R5YlG.js";import"./group-DKztxFm0.js";import"./close-fullscreen-rounded-BQkrG2tL.js";import"./round-search-DSNvd4Y0.js";const sa=C({name:"TriggerType",__name:"trigger-type",emits:["update:value"],setup(N,{emit:h}){const s=h,b=H(),m=c=>{s("update:value",c)};return(c,j)=>{const _=W;return S(),x(_,{value:b.value,"onUpdate:value":[j[0]||(j[0]=l=>b.value=l),m],placeholder:e(a)("common.triggerType.form"),options:e(L)(e(ve)),clearable:""},null,8,["value","placeholder","options"])}}}),ua=C({name:"BlockStrategy",__name:"block-strategy",emits:["update:value"],setup(N,{emit:h}){const s=H(),b=h,m=c=>{b("update:value",c)};return(c,j)=>{const _=W;return S(),x(_,{value:s.value,"onUpdate:value":[j[0]||(j[0]=l=>s.value=l),m],placeholder:e(a)("common.blockStrategy.form"),options:e(L)(e(ke)),clearable:""},null,8,["value","placeholder","options"])}}}),pa=C({name:"TriggerStrategy",__name:"executor-type",emits:["update:value"],setup(N,{emit:h}){const s=H(),b=h,m=c=>{b("update:value",c)};return(c,j)=>{const _=W;return S(),x(_,{value:s.value,"onUpdate:value":[j[0]||(j[0]=l=>s.value=l),m],placeholder:e(a)("common.executorType.form"),options:e(L)(e(je)),clearable:""},null,8,["value","placeholder","options"])}}}),ia=C({name:"TaskType",__name:"task-type",emits:["update:value"],setup(N,{emit:h}){const s=h,b=H(),m=c=>{s("update:value",c)};return(c,j)=>{const _=W;return S(),x(_,{value:b.value,"onUpdate:value":[j[0]||(j[0]=l=>b.value=l),m],placeholder:e(a)("common.routeKey.routeForm"),options:e(L)(e(Se)),clearable:""},null,8,["value","placeholder","options"])}}}),ma=C({name:"JobTaskOperateDrawer",__name:"job-task-operate-drawer",props:Z({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:Z(["submitted"],["update:visible"]),setup(N,{emit:h}){const s=N,b=h,m=oe(N,"visible"),c=re({args:[{arg:""}]}),{formRef:j,validate:_,restoreValidation:l}=Qe(),{defaultRequiredRule:i}=Ye(),$=he(()=>({add:a("page.jobTask.addJobTask"),edit:a("page.jobTask.editJobTask")})[s.operateType]),r=re(D());function D(){return{groupName:"",jobName:"",argsStr:"",argsType:1,jobStatus:1,routeKey:1,executorType:1,triggerType:2,executorInfo:"",triggerInterval:"60",blockStrategy:1,executorTimeout:60,maxRetryTimes:3,retryInterval:1,taskType:1,parallelNum:1,description:""}}const P={groupName:i,jobName:i,argsType:i,jobStatus:i,routeKey:i,executorType:i,executorInfo:i,triggerType:i,triggerInterval:i,blockStrategy:i,executorTimeout:i,maxRetryTimes:i,retryInterval:i,taskType:i,parallelNum:i};function ee(){if(s.operateType==="add"){Object.assign(r,D());return}s.operateType==="edit"&&s.rowData&&(Object.assign(r,s.rowData),r.taskType===3&&r.argsStr&&Object.assign(c,{args:JSON.parse(r.argsStr).map(w=>({arg:w}))}))}function A(){m.value=!1}async function Q(){var w,u;if(await _(),s.operateType==="add"){const{groupName:I,jobName:f,argsType:O,jobStatus:K,routeKey:p,executorType:d,executorInfo:g,triggerType:y,triggerInterval:R,blockStrategy:T,executorTimeout:z,maxRetryTimes:q,retryInterval:V,taskType:E,parallelNum:n,description:U}=r,{error:B}=await Oe({groupName:I,jobName:f,argsStr:Y(),argsType:O,jobStatus:K,routeKey:p,executorType:d,executorInfo:g,triggerType:y,triggerInterval:R,blockStrategy:T,executorTimeout:z,maxRetryTimes:q,retryInterval:V,taskType:E,parallelNum:n,description:U});if(B)return;(w=window.$message)==null||w.success(a("common.addSuccess"))}if(s.operateType==="edit"){const{id:I,groupName:f,jobName:O,argsType:K,jobStatus:p,routeKey:d,executorType:g,executorInfo:y,triggerType:R,triggerInterval:T,blockStrategy:z,executorTimeout:q,maxRetryTimes:V,retryInterval:E,taskType:n,parallelNum:U,description:B}=r,{error:_e}=await Ke({id:I,groupName:f,jobName:O,argsStr:Y(),argsType:K,jobStatus:p,routeKey:d,executorType:g,executorInfo:y,triggerType:R,triggerInterval:T,blockStrategy:z,executorTimeout:q,maxRetryTimes:V,retryInterval:E,taskType:n,parallelNum:U,description:B});if(_e)return;(u=window.$message)==null||u.success(a("common.updateSuccess"))}A(),b("submitted")}function Y(){return r.taskType===3&&c.args?JSON.stringify(c.args.map(w=>w.arg)):r.argsStr}const ae=w=>{c.args.splice(w,1)},te=()=>{c.args.push({arg:""})};return Ne(m,()=>{m.value&&(ee(),l())}),(w,u)=>{const I=me,f=Xe,O=fe,K=ta,p=ea,d=aa,g=Pe,y=M,R=Me,T=de,z=ua,q=sa,V=xe,E=Ze;return S(),x(ye,{modelValue:m.value,"onUpdate:modelValue":u[19]||(u[19]=n=>m.value=n),title:$.value,onHandleSubmit:Q},{footer:o(()=>[t(p,{size:16},{default:o(()=>[t(y,{onClick:A},{default:o(()=>[v(k(e(a)("common.cancel")),1)]),_:1}),t(y,{type:"primary",onClick:Q},{default:o(()=>[v(k(e(a)("common.save")),1)]),_:1})]),_:1})]),default:o(()=>[t(E,{ref_key:"formRef",ref:j,model:r,rules:P},{default:o(()=>[t(f,{label:e(a)("page.jobTask.jobName"),path:"jobName"},{default:o(()=>[t(I,{value:r.jobName,"onUpdate:value":u[0]||(u[0]=n=>r.jobName=n),maxlength:64,"show-count":"",placeholder:e(a)("page.jobTask.form.jobName")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.groupName"),path:"groupName"},{default:o(()=>[t(O,{value:r.groupName,"onUpdate:value":u[1]||(u[1]=n=>r.groupName=n)},null,8,["value"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.jobStatus"),path:"jobStatus"},{default:o(()=>[t(d,{value:r.jobStatus,"onUpdate:value":u[2]||(u[2]=n=>r.jobStatus=n),name:"jobStatus"},{default:o(()=>[t(p,null,{default:o(()=>[(S(!0),le(se,null,ne(e(ie),n=>(S(),x(K,{key:n.value,value:n.value,label:e(a)(n.label)},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.executorType"),path:"executorType"},{default:o(()=>[t(pa,{value:r.executorType,"onUpdate:value":u[3]||(u[3]=n=>r.executorType=n)},null,8,["value"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.executorInfo"),path:"executorInfo"},{default:o(()=>[t(I,{value:r.executorInfo,"onUpdate:value":u[4]||(u[4]=n=>r.executorInfo=n),placeholder:e(a)("page.jobTask.form.executorInfo")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.taskType"),path:"taskType"},{default:o(()=>[t(ia,{value:r.taskType,"onUpdate:value":u[5]||(u[5]=n=>r.taskType=n),placeholder:e(a)("page.jobTask.form.taskType")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.argsStr"),path:"argsStr",rule:r.taskType===3?e(i):void 0},{default:o(()=>[r.taskType===3?(S(),x(T,{key:0,class:"flex-col"},{default:o(()=>[(S(!0),le(se,null,ne(c.args,(n,U)=>(S(),x(f,{key:U,label:`分片参数 ${U+1}`,path:`args[${U}].arg`,"show-feedback":!1,class:"m-b-12px",rule:{required:!0,message:`${e(a)("page.jobTask.form.argsStr")} ${U+1}`,trigger:["input","blur"],validator(){return!!n.arg}}},{default:o(()=>[t(pe,{modelValue:n.arg,"onUpdate:modelValue":B=>n.arg=B,lang:"json",placeholder:e(a)("page.jobTask.form.argsStr")},null,8,["modelValue","onUpdate:modelValue","placeholder"]),t(y,{class:"ml-12px",type:"error",dashed:"",onClick:B=>ae(U)},{default:o(()=>[t(g,{class:"text-icon"})]),_:2},1032,["onClick"])]),_:2},1032,["label","path","rule"]))),128)),t(y,{block:"",dashed:"","attr-type":"button",onClick:te},{default:o(()=>[t(R,{class:"text-icon"})]),_:1})]),_:1})):(S(),x(pe,{key:1,modelValue:r.argsStr,"onUpdate:modelValue":u[6]||(u[6]=n=>r.argsStr=n),lang:"json",placeholder:e(a)("page.jobTask.form.argsStr")},null,8,["modelValue","placeholder"]))]),_:1},8,["label","rule"]),t(f,{label:e(a)("page.jobTask.routeKey"),path:"routeKey"},{default:o(()=>[t(Le,{value:r.routeKey,"onUpdate:value":u[7]||(u[7]=n=>r.routeKey=n),"task-type":r.taskType},null,8,["value","task-type"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.blockStrategy"),path:"blockStrategy"},{default:o(()=>[t(z,{value:r.blockStrategy,"onUpdate:value":u[8]||(u[8]=n=>r.blockStrategy=n)},null,8,["value"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.triggerType"),path:"triggerType"},{default:o(()=>[t(q,{value:r.triggerType,"onUpdate:value":[u[9]||(u[9]=n=>r.triggerType=n),u[10]||(u[10]=n=>r.triggerInterval="")],placeholder:e(a)("page.jobTask.form.triggerType")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.triggerInterval"),path:"triggerInterval"},{default:o(()=>[r.triggerType===2?(S(),x(I,{key:0,value:r.triggerInterval,"onUpdate:value":u[11]||(u[11]=n=>r.triggerInterval=n),placeholder:e(a)("page.jobTask.form.triggerInterval")},null,8,["value","placeholder"])):r.triggerType===3?(S(),x(e(We),{key:1,value:r.triggerInterval,"onUpdate:value":u[12]||(u[12]=n=>r.triggerInterval=n),placeholder:e(a)("page.jobTask.form.triggerInterval_CRON")},null,8,["value","placeholder"])):r.triggerType===99?(S(),x(I,{key:2,value:r.triggerInterval,"onUpdate:value":u[13]||(u[13]=n=>r.triggerInterval=n),disabled:""},null,8,["value"])):we("",!0)]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.executorTimeout"),path:"executorTimeout"},{default:o(()=>[t(V,{value:r.executorTimeout,"onUpdate:value":u[14]||(u[14]=n=>r.executorTimeout=n),min:1,max:60,placeholder:e(a)("page.jobTask.form.executorTimeout"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.maxRetryTimes"),path:"maxRetryTimes"},{default:o(()=>[t(V,{value:r.maxRetryTimes,"onUpdate:value":u[15]||(u[15]=n=>r.maxRetryTimes=n),min:1,max:60,placeholder:e(a)("page.jobTask.form.maxRetryTimes"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.retryInterval"),path:"retryInterval"},{default:o(()=>[t(V,{value:r.retryInterval,"onUpdate:value":u[16]||(u[16]=n=>r.retryInterval=n),min:1,max:60,placeholder:e(a)("page.jobTask.form.retryInterval"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.parallelNum"),path:"parallelNum"},{default:o(()=>[t(V,{value:r.parallelNum,"onUpdate:value":u[17]||(u[17]=n=>r.parallelNum=n),min:1,max:60,placeholder:e(a)("page.jobTask.form.parallelNum"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e(a)("page.jobTask.description"),path:"description"},{default:o(()=>[t(I,{value:r.description,"onUpdate:value":u[18]||(u[18]=n=>r.description=n),type:"textarea",placeholder:e(a)("page.jobTask.form.description")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),da=C({name:"JobTaskSearch",__name:"job-task-search",props:{model:{required:!0},modelModifiers:{}},emits:Z(["reset","search"],["update:model"]),setup(N,{emit:h}){const s=h,b=oe(N,"model");function m(){s("reset")}function c(){s("search")}return(j,_)=>{const l=ze,i=me,$=W,r=oa;return S(),x(r,{model:b.value,onSearch:c,onReset:m},{default:o(()=>[t(l,{span:"24 s:12 m:6",label:e(a)("page.jobTask.groupName"),path:"groupName",class:"pr-24px"},{default:o(()=>[t(fe,{value:b.value.groupName,"onUpdate:value":_[0]||(_[0]=D=>b.value.groupName=D)},null,8,["value"])]),_:1},8,["label"]),t(l,{span:"24 s:12 m:6",label:e(a)("page.jobTask.jobName"),path:"jobName",class:"pr-24px"},{default:o(()=>[t(i,{value:b.value.jobName,"onUpdate:value":_[1]||(_[1]=D=>b.value.jobName=D),placeholder:e(a)("page.jobTask.form.jobName")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l,{span:"24 s:12 m:6",label:e(a)("page.jobTask.jobStatus"),path:"jobStatus",class:"pr-24px"},{default:o(()=>[t($,{value:b.value.jobStatus,"onUpdate:value":_[2]||(_[2]=D=>b.value.jobStatus=D),placeholder:e(a)("page.jobTask.form.jobStatus"),options:e(L)(e(ie))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),ca=C({name:"JobTaskDetailDrawer",__name:"job-task-detail-drawer",props:Z({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(N){const h=oe(N,"visible");return(s,b)=>{const m=ra,c=X,j=na,_=ye;return S(),x(_,{modelValue:h.value,"onUpdate:modelValue":b[0]||(b[0]=l=>h.value=l),title:e(a)("page.jobTask.detail")},{default:o(()=>[t(j,{"label-placement":"top",bordered:"",column:2},{default:o(()=>[t(m,{label:e(a)("page.jobTask.groupName")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.groupName),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.jobName")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.jobName),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.taskType")},{default:o(()=>{var l;return[t(c,{type:e(F)((l=s.rowData)==null?void 0:l.taskType)},{default:o(()=>{var i;return[v(k(e(a)(e(ce)[(i=s.rowData)==null?void 0:i.taskType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.argsStr")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.argsStr),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.nextTriggerAt")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.nextTriggerAt),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.jobStatus")},{default:o(()=>{var l;return[t(c,{type:e(F)((l=s.rowData)==null?void 0:l.jobStatus)},{default:o(()=>{var i;return[v(k(e(a)(e(Ie)[(i=s.rowData)==null?void 0:i.jobStatus])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.routeKey")},{default:o(()=>{var l;return[t(c,{type:e(F)((l=s.rowData)==null?void 0:l.routeKey)},{default:o(()=>{var i;return[v(k(e(a)(e(De)[(i=s.rowData)==null?void 0:i.routeKey])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.executorType")},{default:o(()=>{var l;return[t(c,{type:e(F)((l=s.rowData)==null?void 0:l.executorType)},{default:o(()=>{var i;return[v(k(e(a)(e(Re)[(i=s.rowData)==null?void 0:i.executorType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.executorInfo")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.executorInfo),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.triggerType")},{default:o(()=>{var l;return[t(c,{type:e(F)((l=s.rowData)==null?void 0:l.triggerType)},{default:o(()=>{var i;return[v(k(e(a)(e(ge)[(i=s.rowData)==null?void 0:i.triggerType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.triggerInterval")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.triggerInterval),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.blockStrategy")},{default:o(()=>{var l;return[t(c,{type:e(F)((l=s.rowData)==null?void 0:l.blockStrategy)},{default:o(()=>{var i;return[v(k(e(a)(e(be)[(i=s.rowData)==null?void 0:i.blockStrategy])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.executorTimeout")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.executorTimeout),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.maxRetryTimes")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.maxRetryTimes),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.retryInterval")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.retryInterval),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.parallelNum")},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.parallelNum),1)]}),_:1},8,["label"]),t(m,{label:e(a)("page.jobTask.description"),span:2},{default:o(()=>{var l;return[v(k((l=s.rowData)==null?void 0:l.description),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue","title"])}}}),ga={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function J(N){return typeof N=="function"||Object.prototype.toString.call(N)==="[object Object]"&&!Ce(N)}const Va=C({name:"job_task",__name:"index",setup(N){const{hasAuth:h}=He(),s=Ue(),{routerPushByKey:b}=$e(),m=H(),{bool:c,setTrue:j}=Ve(!1),{columnChecks:_,columns:l,data:i,getData:$,loading:r,mobilePagination:D,searchParams:P,resetSearchParams:ee}=qe({apiFn:Je,apiParams:{page:1,size:10,groupName:null,jobName:null,jobStatus:null},columns:()=>[{key:"index",title:a("common.index"),align:"center",width:40},{key:"jobName",title:a("page.jobTask.jobName"),align:"center",width:140,fixed:"left",render:p=>{async function d(){m.value=p,j()}return t(M,{text:!0,tag:"a",type:"primary",onClick:d,class:"ws-normal"},{default:()=>[p.jobName]})}},{key:"groupName",title:a("page.jobTask.groupName"),align:"left",width:180},{key:"nextTriggerAt",title:a("page.jobTask.nextTriggerAt"),align:"center",width:120},{key:"jobStatus",title:a("page.jobTask.jobStatus"),align:"center",width:60,render:p=>{const d=async(g,y)=>{var T;const{error:R}=await Fe({id:p.id,jobStatus:g});R||(p.jobStatus=g,(T=window.$message)==null||T.success(a("common.updateSuccess"))),y()};return t(Ge,{value:p.jobStatus,"onUpdate:value":g=>p.jobStatus=g,onFetch:d},null)}},{key:"taskType",title:a("page.jobTask.taskType"),align:"center",width:120,render:p=>{if(p.taskType===null)return null;const d={1:"info",2:"success",3:"error"},g=a(ce[p.taskType]);return t(X,{type:d[p.taskType]},J(g)?g:{default:()=>[g]})}},{key:"triggerType",title:a("page.jobTask.triggerType"),align:"center",width:120,render:p=>{if(p.triggerType===null)return null;const d={2:"info",3:"success",99:"error"},g=a(ge[p.triggerType]);return t(X,{type:d[p.triggerType]},J(g)?g:{default:()=>[g]})}},{key:"triggerInterval",title:a("page.jobTask.triggerInterval"),align:"center",width:80},{key:"blockStrategy",title:a("page.jobTask.blockStrategy"),align:"center",width:80,render:p=>{if(p.blockStrategy===null)return null;const d={1:"info",2:"success",3:"error"},g=a(be[p.blockStrategy]);return t(X,{type:d[p.blockStrategy]},J(g)?g:{default:()=>[g]})}},{key:"executorTimeout",title:a("page.jobTask.executorTimeout"),align:"center",width:80},{key:"updateDt",title:a("page.jobTask.updateDt"),align:"center",width:120},{key:"operate",title:a("common.operate"),align:"center",width:180,fixed:"right",render:p=>{let d,g;return t("div",{class:"flex-center gap-8px"},[t(ue,{onPositiveClick:()=>O(p.id)},{default:()=>a("common.confirmExecute"),trigger:()=>{let y;return t(M,{type:"error",ghost:!0,size:"small"},J(y=a("common.execute"))?y:{default:()=>[y]})}}),t(M,{type:"primary",ghost:!0,size:"small",onClick:()=>K(p.id)},J(d=a("common.batchList"))?d:{default:()=>[d]}),t(M,{type:"warning",ghost:!0,size:"small",onClick:()=>f(p.id)},J(g=a("common.edit"))?g:{default:()=>[g]}),h("R_ADMIN")?t(ue,{onPositiveClick:()=>I(p.id)},{default:()=>a("common.confirmDelete"),trigger:()=>{let y;return t(M,{type:"error",ghost:!0,size:"small"},J(y=a("common.delete"))?y:{default:()=>[y]})}}):""])}}]}),{drawerVisible:A,operateType:Q,editingData:Y,handleAdd:ae,handleEdit:te,checkedRowKeys:w,onDeleted:u}=Ee(i,$);async function I(p){const{error:d}=await Ae(p);d||u()}function f(p){te(p)}async function O(p){var g,y;const{error:d}=await Be(p);d?(g=window.$message)==null||g.error(a("common.executeFailed")):(y=window.$message)==null||y.success(a("common.executeSuccess"))}function K(p){b("job_batch",{query:{jobId:p}})}return(p,d)=>{const g=Te,y=la,R=de;return S(),le("div",ga,[t(da,{model:e(P),"onUpdate:model":d[0]||(d[0]=T=>G(P)?P.value=T:null),onReset:e(ee),onSearch:e($)},null,8,["model","onReset","onSearch"]),t(R,{title:e(a)("page.jobTask.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":o(()=>[t(g,{columns:e(_),"onUpdate:columns":d[1]||(d[1]=T=>G(_)?_.value=T:null),loading:e(r),"show-delete":!1,onAdd:e(ae),onRefresh:e($)},null,8,["columns","loading","onAdd","onRefresh"])]),default:o(()=>[t(y,{"checked-row-keys":e(w),"onUpdate:checkedRowKeys":d[2]||(d[2]=T=>G(w)?w.value=T:null),columns:e(l),data:e(i),"flex-height":!e(s).isMobile,"scroll-x":2e3,loading:e(r),remote:"","row-key":T=>T.id,pagination:e(D),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"]),t(ma,{visible:e(A),"onUpdate:visible":d[3]||(d[3]=T=>G(A)?A.value=T:null),"operate-type":e(Q),"row-data":e(Y),onSubmitted:e($)},null,8,["visible","operate-type","row-data","onSubmitted"]),t(ca,{visible:e(c),"onUpdate:visible":d[4]||(d[4]=T=>G(c)?c.value=T:null),"row-data":m.value},null,8,["visible","row-data"])])}}});export{Va as default};
