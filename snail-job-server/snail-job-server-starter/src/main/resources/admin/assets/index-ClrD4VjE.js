import{_ as A,u as j,a as z,b as E}from"./table-Bdl3-G-Y.js";import{bi as D,d as $,U as R,V as C,a as P,$ as a,r as G,W as K,o as U,c as F,w as i,f as n,g as V,t as B,h as e,n as M,B as O,s as W,b as H,ad as I,I as L,ae as Z}from"./index-CHgAHQIl.js";import{u as J,a as Q}from"./form-BuwwOwyC.js";import{_ as X}from"./operate-drawer-3XJn0MkC.js";import{_ as Y,a as ee}from"./FormItem-B3tfy17D.js";import{_ as ae}from"./Space-CeVCCXQI.js";import{_ as te}from"./search-form.vue_vue_type_script_setup_true_lang-BfZ4by1v.js";import{_ as ne}from"./Grid-DHGKk79k.js";import"./close-fullscreen-rounded-DtEdfPev.js";import"./round-search-KK91k1IY.js";function oe(o){return D({url:"/namespace/list",method:"get",params:o})}function se(o){return D({url:"/namespace",method:"post",data:o})}function le(o){return D({url:"/namespace",method:"put",data:o})}const re=$({name:"NamespaceOperateDrawer",__name:"namespace-operate-drawer",props:R({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:R(["submitted"],["update:visible"]),setup(o,{emit:y}){const r=o,m=y,u=C(o,"visible"),{formRef:p,validate:k,restoreValidation:h}=J(),{defaultRequiredRule:f}=Q(),N=P(()=>({add:a("page.namespace.addNamespace"),edit:a("page.namespace.editNamespace")})[r.operateType]),s=G(w());function w(){return{name:"",uniqueId:""}}const q={name:f,uniqueId:{required:!1,pattern:/^[A-Za-z0-9_-]{1,64}$/,trigger:"change",message:a("page.namespace.form.uniqueIdRule")}};function T(){if(r.operateType==="add"){Object.assign(s,w());return}r.operateType==="edit"&&r.rowData&&Object.assign(s,r.rowData)}function S(){u.value=!1}async function _(){var b,l;if(await k(),r.operateType==="add"){const{name:t,uniqueId:c}=s,{error:g}=await se({name:t,uniqueId:c});if(g)return;(b=window.$message)==null||b.success(a("common.addSuccess"))}if(r.operateType==="edit"){const{id:t,name:c,uniqueId:g}=s,{error:v}=await le({id:t,name:c,uniqueId:g});if(v)return;(l=window.$message)==null||l.success(a("common.updateSuccess"))}S(),m("submitted")}return K(u,()=>{u.value&&(T(),h())}),(b,l)=>{const t=M,c=Y,g=ee,v=O,d=ae;return U(),F(X,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=x=>u.value=x),title:N.value,onSubmitted:_},{footer:i(()=>[n(d,{size:16},{default:i(()=>[n(v,{onClick:S},{default:i(()=>[V(B(e(a)("common.cancel")),1)]),_:1}),n(v,{type:"primary",onClick:_},{default:i(()=>[V(B(e(a)("common.save")),1)]),_:1})]),_:1})]),default:i(()=>[n(g,{ref_key:"formRef",ref:p,model:s,rules:q},{default:i(()=>[n(c,{label:e(a)("page.namespace.uniqueId"),path:"uniqueId"},{default:i(()=>[n(t,{value:s.uniqueId,"onUpdate:value":l[0]||(l[0]=x=>s.uniqueId=x),disabled:r.operateType==="edit",placeholder:e(a)("page.namespace.form.uniqueId")},null,8,["value","disabled","placeholder"])]),_:1},8,["label"]),n(c,{label:e(a)("page.namespace.name"),path:"name"},{default:i(()=>[n(t,{value:s.name,"onUpdate:value":l[1]||(l[1]=x=>s.name=x),placeholder:e(a)("page.namespace.form.name")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ie=$({name:"NamespaceSearch",__name:"namespace-search",props:{model:{required:!0},modelModifiers:{}},emits:R(["reset","search"],["update:model"]),setup(o,{emit:y}){const r=y,m=C(o,"model");function u(){r("reset")}function p(){r("search")}return(k,h)=>{const f=M,N=A,s=te;return U(),F(s,{model:m.value,onSearch:p,onReset:u},{default:i(()=>[n(N,{span:"24 s:12 m:6",label:e(a)("page.namespace.keyword"),path:"keyword",class:"pr-24px"},{default:i(()=>[n(f,{value:m.value.keyword,"onUpdate:value":h[0]||(h[0]=w=>m.value.keyword=w),placeholder:e(a)("page.namespace.form.keyword")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),de={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function ue(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!Z(o)}const ye=$({name:"namespace",__name:"index",setup(o){const y=W(),{columns:r,columnChecks:m,data:u,getData:p,loading:k,mobilePagination:h,searchParams:f,resetSearchParams:N}=j({apiFn:oe,apiParams:{page:1,size:10,keyword:null},columns:()=>[{key:"name",title:a("page.namespace.name"),align:"left",width:120},{key:"uniqueId",title:a("page.namespace.uniqueId"),align:"left",width:180},{key:"createDt",title:a("page.common.createTime"),align:"left",width:130},{key:"updateDt",title:a("page.common.upadteTime"),align:"left",width:130},{key:"operate",title:a("common.operate"),align:"center",width:64,render:l=>{let t;return n("div",{class:"flex-center gap-8px"},[n(O,{type:"primary",text:!0,ghost:!0,size:"small",onClick:()=>b(l.id)},ue(t=a("common.edit"))?t:{default:()=>[t]})])}}]}),{drawerVisible:s,operateType:w,editingData:q,handleAdd:T,handleEdit:S,checkedRowKeys:_}=z(u,p);function b(l){S(l)}return(l,t)=>{const c=E,g=ne,v=L;return U(),H("div",de,[n(ie,{model:e(f),"onUpdate:model":t[0]||(t[0]=d=>I(f)?f.value=d:null),onReset:e(N),onSearch:e(p)},null,8,["model","onReset","onSearch"]),n(v,{title:e(a)("page.namespace.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":i(()=>[n(c,{columns:e(m),"onUpdate:columns":t[1]||(t[1]=d=>I(m)?m.value=d:null),"disabled-delete":e(_).length===0,loading:e(k),"show-delete":!1,onAdd:e(T),onRefresh:e(p)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:i(()=>[n(g,{"checked-row-keys":e(_),"onUpdate:checkedRowKeys":t[2]||(t[2]=d=>I(_)?_.value=d:null),columns:e(r),data:e(u),"flex-height":!e(y).isMobile,"scroll-x":962,loading:e(k),remote:"","row-key":d=>d.id,pagination:e(h),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),n(re,{visible:e(s),"onUpdate:visible":t[3]||(t[3]=d=>I(s)?s.value=d:null),"operate-type":e(w),"row-data":e(q),onSubmitted:e(p)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{ye as default};
