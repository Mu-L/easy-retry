import{bj as L,d as Z,U as j,V as Y,o as V,c as q,w as o,aX as Te,f as e,be as Se,g as h,t as v,B,S as Q,b as me,e as ce,a as we,$ as a,r as fe,p as M,W as ge,i as ae,h as t,a1 as X,Y as oe,dy as le,a3 as ne,n as re,a2 as De,O as Ie,bk as ze,a4 as ee,cw as ye,cv as _e,N as te,bi as xe,bh as Re,a8 as de,s as Ue,a9 as H,I as $e,aa as Ce}from"./index-DQvTTbM-.js";import{d as Ve,e as Ae,b as Be,c as Me,N as E,_ as qe,u as Le,a as Pe}from"./table-BY-eM7wn.js";import{_ as se}from"./Space-B5Upi9VN.js";import{u as be,a as he,_ as ve,b as Ne}from"./form-Bu4MD_Ly.js";import{_ as ue}from"./operate-drawer-CZXJ_kn-.js";import{e as ie}from"./group-DKztxFm0.js";import{f as ke}from"./retry-scene-BU9f1qWu.js";import{_ as Ge}from"./code-mirror.vue_vue_type_script_setup_true_lang-Cgtmy6g2.js";import{_ as Oe}from"./search-form.vue_vue_type_script_setup_true_lang-gb65EZBS.js";import{_ as We,a as Fe}from"./log-kdQNaTzi.js";import{_ as je,a as He}from"./DescriptionsItem-Bd4R5YlG.js";import{b as Ee}from"./Grid-CSTnYjse.js";import"./close-fullscreen-rounded-BQkrG2tL.js";import"./round-search-DSNvd4Y0.js";import"./CollapseItem-Cc60zQbl.js";function Ze(p){return L({url:"/retry-task/list",method:"get",params:p})}function Ke(p,S){return L({url:`/retry-task/${p}?groupName=${S}`,method:"get"})}function Xe(p){return L({url:"/retry-task",method:"post",data:p})}function Ye(p){return L({url:"/retry-task/batch",method:"post",data:p})}function Je(p){return L({url:"/retry-task/status",method:"put",data:p})}function Qe(p){return L({url:"/retry-task/manual/trigger/retry/task",method:"post",data:p})}function pe(p){return L({url:"/retry-task/batch",method:"delete",data:p})}function et(p){return L({url:"/retry-task/generate/idempotent-id",method:"post",data:p})}const tt=Z({name:"CustomerTableHeaderOperation",__name:"customer-table-header-operation",props:j({itemAlign:{},disabledDelete:{type:Boolean},loading:{type:Boolean},showDelete:{type:Boolean,default:!0},showAdd:{type:Boolean,default:!0}},{columns:{default:()=>[]},columnsModifiers:{}}),emits:j(["add","batchAdd","delete","refresh"],["update:columns"]),setup(p,{emit:S}){const g=S,m=Y(p,"columns");function N(){g("add")}function R(){g("batchAdd")}function I(){g("delete")}function w(){g("refresh")}return(s,z)=>{const i=Be,f=B,u=Me,b=E,y=Ve,T=Ae,d=se;return V(),q(d,{align:s.itemAlign,wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:o(()=>[Te(s.$slots,"default",{},()=>[s.showAdd?(V(),q(f,{key:0,size:"small",ghost:"",type:"primary",onClick:N},{icon:o(()=>[e(i,{class:"text-icon"})]),default:o(()=>[h(" "+v(s.$t("common.add")),1)]),_:1})):Q("",!0),s.showAdd?(V(),q(f,{key:1,size:"small",ghost:"",type:"primary",onClick:R},{icon:o(()=>[e(i,{class:"text-icon"})]),default:o(()=>[h(" "+v(s.$t("common.batchAdd")),1)]),_:1})):Q("",!0),s.showDelete?(V(),q(b,{key:2,onPositiveClick:I},{trigger:o(()=>[e(f,{size:"small",ghost:"",type:"error",disabled:s.disabledDelete},{icon:o(()=>[e(u,{class:"text-icon"})]),default:o(()=>[h(" "+v(s.$t("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:o(()=>[h(" "+v(s.$t("common.confirmDelete")),1)]),_:1})):Q("",!0)]),e(f,{size:"small",onClick:w},{icon:o(()=>[e(y,{class:Se(["text-icon",{"animate-spin":s.loading}])},null,8,["class"])]),default:o(()=>[h(" "+v(s.$t("common.refresh")),1)]),_:1}),e(T,{columns:m.value,"onUpdate:columns":z[0]||(z[0]=x=>m.value=x)},null,8,["columns"])]),_:3},8,["align"])}}}),at={class:"inline-block",viewBox:"0 0 36 36",width:"1em",height:"1em"},ot=ce("path",{fill:"currentColor",d:"M15 32H3a1 1 0 0 0 0 2h12a1 1 0 0 0 0-2M5 30h8a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v25a1 1 0 0 0 1 1M9 5.92a1.5 1.5 0 1 1-1.5 1.5A1.5 1.5 0 0 1 9 5.92M6 12.2h5.84v1.6H6Zm0 3h5.84v1.6H6Zm0 3h6v1.6H6ZM16 8h2v1.6h-2zm4 0h2v1.6h-2zm13-3.8h-8a.8.8 0 0 0-.8.8v6a.8.8 0 0 0 .8.8h8a.8.8 0 0 0 .8-.8V5a.8.8 0 0 0-.8-.8m-.8 6h-6.4V5.8h6.4ZM16 20h2v1.6h-2zm4 0h2v1.6h-2zm13-3.8h-8a.8.8 0 0 0-.8.8v6a.8.8 0 0 0 .8.8h8a.8.8 0 0 0 .8-.8v-6a.8.8 0 0 0-.8-.8m-.8 6h-6.4v-4.4h6.4Z"},null,-1),lt=ce("path",{fill:"none",d:"M0 0h36v36H0z"},null,-1),nt=[ot,lt];function rt(p,S){return V(),me("svg",at,[...nt])}const st={name:"clarity-thin-client-solid",render:rt},ut=Z({name:"RetryTaskOperateDrawer",__name:"retry-task-operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(p,{emit:S}){const g=p,m=S,N=Y(p,"visible"),{formRef:R,validate:I,restoreValidation:w}=be(),{defaultRequiredRule:s}=he(),z=we(()=>({add:a("page.retryTask.addRetryTask"),edit:a("page.retryTask.editRetryTask")})[g.operateType]),i=fe(b()),f=M([]),u=M([]);function b(){return{groupName:"",sceneName:"",idempotentId:"",bizNo:"",executorName:"",argsStr:"",retryStatus:0}}const y={groupName:s,sceneName:s,idempotentId:s,bizNo:s,executorName:s,argsStr:s,retryStatus:s};function T(){if(g.operateType==="add"){Object.assign(i,b());return}g.operateType==="edit"&&g.rowData&&Object.assign(i,g.rowData)}function d(){N.value=!1}async function x(){var l;if(await I(),g.operateType==="add"){const{groupName:c,sceneName:k,idempotentId:U,bizNo:A,executorName:G,argsStr:O,retryStatus:K}=i,{error:W}=await Xe({groupName:c,sceneName:k,idempotentId:U,bizNo:A,executorName:G,argsStr:O,retryStatus:K});if(W)return;(l=window.$message)==null||l.success(a("common.addSuccess"))}d(),m("submitted")}ge(N,()=>{N.value&&(T(),w())});async function C(){const l=await ie();f.value=l.data}async function $(l){if(l){const c=await ke({groupName:l});u.value=c.data.map(k=>k.sceneName)}else i.sceneName="",u.value=[]}async function P(){const l=i.groupName,c=i.sceneName,k=i.executorName,U=i.argsStr,{data:A,error:G}=await et({groupName:l,sceneName:c,executorName:k,argsStr:U});G||(i.idempotentId=A)}return ae(()=>{C()}),(l,c)=>{const k=ne,U=ve,A=re,G=st,O=B,K=De,W=Ie,r=Ne,n=se;return V(),q(ue,{modelValue:N.value,"onUpdate:modelValue":c[7]||(c[7]=_=>N.value=_),title:z.value,onHandleSubmit:x},{footer:o(()=>[e(n,{size:16},{default:o(()=>[e(O,{onClick:d},{default:o(()=>[h(v(t(a)("common.cancel")),1)]),_:1}),e(O,{type:"primary",onClick:x},{default:o(()=>[h(v(t(a)("common.save")),1)]),_:1})]),_:1})]),default:o(()=>[e(r,{ref_key:"formRef",ref:R,model:i,rules:y},{default:o(()=>[e(U,{label:t(a)("page.retryTask.groupName"),path:"groupName"},{default:o(()=>[e(k,{value:i.groupName,"onUpdate:value":c[0]||(c[0]=_=>i.groupName=_),placeholder:t(a)("page.retryTask.form.groupName"),options:t(X)(f.value),disabled:g.operateType==="edit",onUpdateValue:$},null,8,["value","placeholder","options","disabled"])]),_:1},8,["label"]),e(U,{label:t(a)("page.retryTask.sceneName"),path:"sceneName"},{default:o(()=>[e(k,{value:i.sceneName,"onUpdate:value":c[1]||(c[1]=_=>i.sceneName=_),placeholder:t(a)("page.retryTask.form.sceneName"),options:t(X)(u.value),disabled:g.operateType==="edit"},null,8,["value","placeholder","options","disabled"])]),_:1},8,["label"]),e(U,{label:t(a)("page.retryTask.idempotentId"),path:"idempotentId"},{default:o(()=>[e(W,null,{default:o(()=>[e(A,{value:i.idempotentId,"onUpdate:value":c[2]||(c[2]=_=>i.idempotentId=_),placeholder:t(a)("page.retryTask.form.idempotentId"),disabled:g.operateType==="edit"},null,8,["value","placeholder","disabled"]),e(K,{trigger:"hover"},{trigger:o(()=>[e(O,{type:"default",ghost:"",disabled:g.operateType==="edit",onClick:P},{default:o(()=>[e(G,{class:"text-icon"})]),_:1},8,["disabled"])]),default:o(()=>[h(" "+v(t(a)("page.retryTask.generateIdempotentId")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(U,{label:t(a)("page.retryTask.bizNo"),path:"bizNo"},{default:o(()=>[e(A,{value:i.bizNo,"onUpdate:value":c[3]||(c[3]=_=>i.bizNo=_),placeholder:t(a)("page.retryTask.form.bizNo"),disabled:g.operateType==="edit"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),e(U,{label:t(a)("page.retryTask.executorName"),path:"executorName"},{default:o(()=>[e(A,{value:i.executorName,"onUpdate:value":c[4]||(c[4]=_=>i.executorName=_),placeholder:t(a)("page.retryTask.form.executorName"),disabled:g.operateType==="edit"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),e(U,{label:t(a)("page.retryTask.argsStr"),path:"argsStr"},{default:o(()=>[e(Ge,{modelValue:i.argsStr,"onUpdate:modelValue":c[5]||(c[5]=_=>i.argsStr=_),lang:"json",placeholder:t(a)("page.jobTask.form.argsStr")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(U,{label:t(a)("page.retryTask.retryStatus"),path:"retryStatus"},{default:o(()=>[e(k,{value:i.retryStatus,"onUpdate:value":c[6]||(c[6]=_=>i.retryStatus=_),placeholder:t(a)("page.retryTask.form.retryStatus"),options:t(oe)(t(le))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),it=Z({name:"RetryTaskBatchAddDrawer",__name:"retry-task-batch-add-drawer",props:{visible:{type:Boolean,default:!1},visibleModifiers:{}},emits:j(["submitted"],["update:visible"]),setup(p,{emit:S}){const g=S,m=Y(p,"visible"),{formRef:N,validate:R,restoreValidation:I}=be(),{defaultRequiredRule:w}=he(),s=fe(i()),z=M([]);function i(){return{groupName:"",retryStatus:0,logStr:""}}const f={groupName:w,retryStatus:w,logStr:w};function u(){m.value=!1}async function b(){var $;await R();const{groupName:T,retryStatus:d,logStr:x}=s,{error:C}=await Ye({groupName:T,retryStatus:d,logStr:x});C||(($=window.$message)==null||$.success(a("common.addSuccess")),u(),g("submitted"))}async function y(){const T=await ie();z.value=T.data}return ge(m,()=>{m.value&&I()}),ae(()=>{y()}),(T,d)=>{const x=ne,C=ve,$=re,P=Ne,l=B,c=se;return V(),q(ue,{modelValue:m.value,"onUpdate:modelValue":d[3]||(d[3]=k=>m.value=k),title:t(a)("page.retryTask.batchAddRetryTask"),onHandleSubmit:b},{footer:o(()=>[e(c,{size:16},{default:o(()=>[e(l,{onClick:u},{default:o(()=>[h(v(t(a)("common.cancel")),1)]),_:1}),e(l,{type:"primary",onClick:b},{default:o(()=>[h(v(t(a)("common.save")),1)]),_:1})]),_:1})]),default:o(()=>[e(P,{ref_key:"formRef",ref:N,model:s,rules:f},{default:o(()=>[e(C,{label:t(a)("page.retryTask.groupName"),path:"groupName"},{default:o(()=>[e(x,{value:s.groupName,"onUpdate:value":d[0]||(d[0]=k=>s.groupName=k),placeholder:t(a)("page.retryTask.form.groupName"),options:t(X)(z.value)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),e(C,{label:t(a)("page.retryTask.retryStatus"),path:"retryStatus"},{default:o(()=>[e(x,{value:s.retryStatus,"onUpdate:value":d[1]||(d[1]=k=>s.retryStatus=k),placeholder:t(a)("page.retryTask.form.retryStatus"),options:t(oe)(t(le))},null,8,["value","placeholder","options"])]),_:1},8,["label"]),e(C,{label:t(a)("page.retryTask.form.logStr"),path:"logStr"},{default:o(()=>[e($,{value:s.logStr,"onUpdate:value":d[2]||(d[2]=k=>s.logStr=k),type:"textarea",placeholder:t(a)("page.retryTask.form.logStr")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),dt=Z({name:"RetryTaskSearch",__name:"retry-task-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(p,{emit:S}){const g=S,m=Y(p,"model"),N=M([]),R=M([]);function I(){g("reset")}function w(){g("search")}async function s(){const i=await ie();N.value=i.data}async function z(i){if(i){const f=await ke({groupName:i});R.value=f.data.map(u=>u.sceneName)}else m.value.sceneName="",R.value=[]}return ae(()=>{s()}),(i,f)=>{const u=ne,b=qe,y=re,T=Oe;return V(),q(T,{model:m.value,onSearch:w,onReset:I},{default:o(()=>[e(b,{span:"24 s:12 m:6",label:t(a)("page.retryTask.groupName"),path:"groupName",class:"pr-24px"},{default:o(()=>[e(u,{value:m.value.groupName,"onUpdate:value":[f[0]||(f[0]=d=>m.value.groupName=d),z],placeholder:t(a)("page.retryTask.form.groupName"),options:t(X)(N.value),clearable:"",filterable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),e(b,{span:"24 s:12 m:6",label:t(a)("page.retryTask.sceneName"),path:"sceneName",class:"pr-24px"},{default:o(()=>[e(u,{value:m.value.sceneName,"onUpdate:value":f[1]||(f[1]=d=>m.value.sceneName=d),placeholder:t(a)("page.retryTask.form.sceneName"),options:t(X)(R.value),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),e(b,{span:"24 s:12 m:6",label:t(a)("page.retryTask.uniqueId"),path:"uniqueId",class:"pr-24px"},{default:o(()=>[e(y,{value:m.value.uniqueId,"onUpdate:value":f[2]||(f[2]=d=>m.value.uniqueId=d),placeholder:t(a)("page.retryTask.form.uniqueId")},null,8,["value","placeholder"])]),_:1},8,["label"]),e(b,{span:"24 s:12 m:6",label:t(a)("page.retryTask.idempotentId"),path:"idempotentId",class:"pr-24px"},{default:o(()=>[e(y,{value:m.value.idempotentId,"onUpdate:value":f[3]||(f[3]=d=>m.value.idempotentId=d),placeholder:t(a)("page.retryTask.form.idempotentId")},null,8,["value","placeholder"])]),_:1},8,["label"]),e(b,{span:"24 s:12 m:6",label:t(a)("page.retryTask.bizNo"),path:"bizNo",class:"pr-24px"},{default:o(()=>[e(y,{value:m.value.bizNo,"onUpdate:value":f[4]||(f[4]=d=>m.value.bizNo=d),placeholder:t(a)("page.retryTask.form.bizNo")},null,8,["value","placeholder"])]),_:1},8,["label"]),e(b,{span:"24 s:12 m:6",label:t(a)("page.retryTask.retryStatus"),path:"retryStatus",class:"pr-24px"},{default:o(()=>[e(u,{value:m.value.retryStatus,"onUpdate:value":f[5]||(f[5]=d=>m.value.retryStatus=d),placeholder:t(a)("page.retryTask.form.retryStatus"),options:t(oe)(t(le))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),pt=Z({name:"SceneDetailDrawer",__name:"retry-task-detail-drawer",props:j({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(p){const S=p,g=Y(p,"visible"),m=M([]),N=M(),R=new AbortController,I=M(!1);let w="0",s=0;async function z(){const{data:u,error:b}=await Fe({groupName:S.rowData.groupName,uniqueId:S.rowData.uniqueId,startId:w,fromIndex:s,size:50});b||(I.value=u.finished,w=u.nextStartId,s=u.fromIndex,u.message&&(m.value.push(...u.message),m.value.sort((y,T)=>Number.parseInt(y.time_stamp,10)-Number.parseInt(T.time_stamp,10))),I.value||(clearTimeout(N.value),N.value=setTimeout(z,1e3)))}const i=async u=>{u===1&&m.value.length===0&&await z()},f=()=>{I.value=!0,R.abort(),clearTimeout(N.value),N.value=void 0};return ze(()=>{f()}),(u,b)=>{const y=je,T=te,d=He,x=xe,C=We,$=Re,P=ue;return V(),q(P,{modelValue:g.value,"onUpdate:modelValue":b[1]||(b[1]=l=>g.value=l),title:t(a)("page.retryTask.detail")},{default:o(()=>[e($,{type:"segment",animated:"","onUpdate:value":i},{default:o(()=>[e(x,{name:0,tab:t(a)("page.log.info")},{default:o(()=>[e(d,{"label-placement":"top",bordered:"",column:2},{default:o(()=>[e(y,{label:t(a)("page.retryTask.uniqueId"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.uniqueId),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.groupName"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.groupName),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.sceneName"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.sceneName),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.nextTriggerAt"),span:1},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.nextTriggerAt),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.retryCount"),span:1},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.retryCount),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.retryStatus"),span:1},{default:o(()=>{var l;return[e(T,{type:t(ee)((l=u.rowData)==null?void 0:l.retryStatus)},{default:o(()=>{var c;return[h(v(t(a)(t(ye)[(c=u.rowData)==null?void 0:c.retryStatus])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.taskType"),span:1},{default:o(()=>{var l;return[e(T,{type:t(ee)((l=u.rowData)==null?void 0:l.taskType)},{default:o(()=>{var c;return[h(v(t(a)(t(_e)[(c=u.rowData)==null?void 0:c.taskType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.bizNo"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.bizNo),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.idempotentId"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.idempotentId),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.executorName"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.executorName),1)]}),_:1},8,["label"]),e(y,{label:t(a)("page.retryTask.argsStr"),span:2},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.argsStr),1)]}),_:1},8,["label"]),e(y,{label:t(a)("common.createDt"),span:1},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.createDt),1)]}),_:1},8,["label"]),e(y,{label:t(a)("common.updateDt"),span:1},{default:o(()=>{var l;return[h(v((l=u.rowData)==null?void 0:l.updateDt),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["tab"]),e(x,{name:1,tab:t(a)("page.log.title"),"display-directive":"if"},{default:o(()=>[e(C,{modelValue:m.value,"onUpdate:modelValue":b[0]||(b[0]=l=>m.value=l),drawer:!1},null,8,["modelValue"])]),_:1},8,["tab"])]),_:1})]),_:1},8,["modelValue","title"])}}}),mt={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function F(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!Ce(p)}const zt=Z({name:"retry_task",__name:"index",setup(p){const S=M(),{bool:g,setTrue:m}=de(!1),N=Ue(),{columns:R,columnChecks:I,data:w,getData:s,loading:z,mobilePagination:i,searchParams:f,resetSearchParams:u}=Le({apiFn:Ze,apiParams:{page:1,size:10,uniqueId:null,groupName:null,sceneName:null,idempotentId:null,bizNo:null,retryStatus:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"uniqueId",title:a("page.retryTask.uniqueId"),align:"left",fixed:"left",minWidth:120,render:r=>{async function n(){await c(r),m()}return e(B,{text:!0,tag:"a",type:"primary",onClick:n,class:"ws-normal"},{default:()=>[r.uniqueId]})}},{key:"groupName",title:a("page.retryTask.groupName"),align:"left",resizable:!0,minWidth:120,maxWidth:250},{key:"sceneName",title:a("page.retryTask.sceneName"),align:"left",minWidth:120},{key:"nextTriggerAt",title:a("page.retryTask.nextTriggerAt"),align:"left",resizable:!0,minWidth:120,maxWidth:150},{key:"retryCount",title:a("page.retryTask.retryCount"),align:"center",width:80},{key:"retryStatus",title:a("page.retryTask.retryStatus"),align:"left",width:120,render:r=>{if(r.retryStatus===null)return null;const n=a(ye[r.retryStatus]);return e(te,{type:ee(r.retryStatus)},F(n)?n:{default:()=>[n]})}},{key:"taskType",title:a("page.retryTask.taskType"),align:"left",width:100,render:r=>{if(r.taskType===null)return null;const n={1:"warning",2:"error"},_=a(_e[r.taskType]);return e(te,{type:n[r.taskType]},F(_)?_:{default:()=>[_]})}},{key:"idempotentId",title:a("page.retryTask.idempotentId"),align:"left",resizable:!0,minWidth:150,maxWidth:300},{key:"bizNo",title:a("page.retryTask.bizNo"),align:"left",resizable:!0,minWidth:150,maxWidth:300},{key:"operate",title:a("common.operate"),align:"left",width:260,fixed:"right",render:r=>e("div",{class:"flex-center gap-8px"},[r.retryStatus!==1&&r.retryStatus!==2?e(E,{onPositiveClick:()=>A(r.groupName,r.uniqueId)},{default:()=>a("common.confirmExecute"),trigger:()=>{let n;return e(B,{type:"info",ghost:!0,size:"small"},F(n=a("common.execute"))?n:{default:()=>[n]})}}):"",r.retryStatus!==1&&r.retryStatus!==2?e(E,{onPositiveClick:()=>K(Number(r.id),r.groupName)},{default:()=>a("common.confirmFinish"),trigger:()=>{let n;return e(B,{type:"warning",ghost:!0,size:"small"},F(n=a("common.finish"))?n:{default:()=>[n]})}}):"",r.retryStatus===0?e(E,{onPositiveClick:()=>O(Number(r.id),r.groupName)},{default:()=>a("common.confirmPause"),trigger:()=>{let n;return e(B,{type:"success",ghost:!0,size:"small"},F(n=a("common.pause"))?n:{default:()=>[n]})}}):"",r.retryStatus===3?e(E,{onPositiveClick:()=>G(Number(r.id),r.groupName)},{default:()=>a("common.confirmResume"),trigger:()=>{let n;return e(B,{type:"info",ghost:!0,size:"small"},F(n=a("common.resume"))?n:{default:()=>[n]})}}):"",e(E,{onPositiveClick:()=>l(r.groupName,r.id)},{default:()=>a("common.confirmDelete"),trigger:()=>{let n;return e(B,{type:"error",ghost:!0,size:"small"},F(n=a("common.delete"))?n:{default:()=>[n]})}})])}]}),{drawerVisible:b,operateType:y,handleAdd:T,checkedRowKeys:d,onBatchDeleted:x,onDeleted:C}=Pe(w,s),{bool:$,setTrue:P}=de();async function l(r,n){const{error:_}=await pe({groupName:r,ids:[n]});_||C()}async function c(r){const n=await Ke(r.id,r.groupName);S.value=n.data||null}async function k(){const r=d.value;if(r.length===0)return;const n=w.value[0].groupName,{error:_}=await pe({groupName:n,ids:r});_||x()}function U(){P()}function A(r,n){Qe({groupName:r,uniqueIds:[n]})}function G(r,n){W(r,n,0)}function O(r,n){W(r,n,3)}function K(r,n){W(r,n,1)}async function W(r,n,_){var D;const{error:J}=await Je({id:r,groupName:n,retryStatus:_});J||((D=window.$message)==null||D.success(a("common.updateSuccess")),s())}return(r,n)=>{const _=Ee,J=$e;return V(),me("div",mt,[e(dt,{model:t(f),"onUpdate:model":n[0]||(n[0]=D=>H(f)?f.value=D:null),onReset:t(u),onSearch:t(s)},null,8,["model","onReset","onSearch"]),e(J,{title:t(a)("page.retryTask.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":o(()=>[e(tt,{columns:t(I),"onUpdate:columns":n[1]||(n[1]=D=>H(I)?I.value=D:null),"disabled-delete":t(d).length===0,loading:t(z),onAdd:t(T),onBatchAdd:U,onDelete:k,onRefresh:t(s)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:o(()=>[e(_,{"checked-row-keys":t(d),"onUpdate:checkedRowKeys":n[2]||(n[2]=D=>H(d)?d.value=D:null),columns:t(R),data:t(w),"flex-height":!t(N).isMobile,"scroll-x":2e3,loading:t(z),remote:"","row-key":D=>D.id,pagination:t(i),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),e(ut,{visible:t(b),"onUpdate:visible":n[3]||(n[3]=D=>H(b)?b.value=D:null),"operate-type":t(y),onSubmitted:t(s)},null,8,["visible","operate-type","onSubmitted"]),e(it,{visible:t($),"onUpdate:visible":n[4]||(n[4]=D=>H($)?$.value=D:null),onSubmitted:t(s)},null,8,["visible","onSubmitted"]),e(pt,{visible:t(g),"onUpdate:visible":n[5]||(n[5]=D=>H(g)?g.value=D:null),"row-data":S.value},null,8,["visible","row-data"])]),_:1},8,["title"])])}}});export{zt as default};
