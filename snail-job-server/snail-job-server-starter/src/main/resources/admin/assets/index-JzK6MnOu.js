import{_ as xe}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CAikEgod.js";import{as as we,av as Ie,d as D,ax as Re,aA as be,a as ne,a_ as ue,aH as De,aj as pe,bo as $e,p as A,o as N,c as I,h as e,$ as a,Y as Q,bp as Ue,a3 as Y,bq as Ve,br as Ce,bs as ze,U as W,V as oe,s as fe,W as ee,b as te,w as l,f as t,g as j,S as Oe,bt as ye,O as Be,n as se,r as ie,t as S,Q as de,bu as _e,R as me,B as M,I as ve,a4 as F,bv as Te,bw as Ke,bx as Je,bn as Ae,by as ke,bz as he,N as ae,u as Pe,a8 as Fe,a9 as H,aa as Me}from"./index-DydImCNJ.js";import{b as Le,c as Ge,d as Ee,e as qe,g as He,h as We}from"./job-BRYX1dc1.js";import{b as Qe,c as Ye,_ as Xe,u as Ze,a as ea,N as ce}from"./table-BB81mEh2.js";import{_ as aa}from"./status-switch.vue_vue_type_script_setup_true_lang-D630MRHb.js";import{u as ta}from"./auth-Cj-gcKGG.js";import{_ as je}from"./select-group.vue_vue_type_script_setup_true_lang-Bwh6kebD.js";import{u as oa,a as la,_ as ra,b as na}from"./form-CXP3EjI2.js";import{_ as Se}from"./operate-drawer-B2Yn2ELy.js";import{_ as sa,a as ua}from"./cron-input.vue_vue_type_style_index_0_lang-D7T5LX3f.js";import{_ as ge}from"./code-mirror.vue_vue_type_script_setup_true_lang-snMzIKKF.js";import{_ as pa}from"./Space-HTlydpS2.js";import{_ as ia,a as da,b as ma}from"./Grid-C0ryvMLX.js";import{_ as ca}from"./search-form.vue_vue_type_script_setup_true_lang-G2vaTHhL.js";import{_ as ga,a as ba}from"./DescriptionsItem-BKhQ5GOr.js";import"./group-DHxaJaDV.js";import"./close-fullscreen-rounded-Cdf1DUar.js";import"./round-search-BN-yNV5a.js";const fa=we("input-group-label",`
 position: relative;
 user-select: none;
 -webkit-user-select: none;
 box-sizing: border-box;
 padding: 0 12px;
 display: inline-block;
 border-radius: var(--n-border-radius);
 background-color: var(--n-group-label-color);
 color: var(--n-group-label-text-color);
 font-size: var(--n-font-size);
 line-height: var(--n-height);
 height: var(--n-height);
 flex-shrink: 0;
 white-space: nowrap;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
`,[Ie("border",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 border: var(--n-group-label-border);
 transition: border-color .3s var(--n-bezier);
 `)]),ya=Object.assign(Object.assign({},be.props),{size:{type:String,default:"medium"},bordered:{type:Boolean,default:void 0}}),_a=D({name:"InputGroupLabel",props:ya,setup(_){const{mergedBorderedRef:v,mergedClsPrefixRef:r,inlineThemeDisabled:b}=Re(_),u=be("Input","-input-group-label",fa,$e,_,r),m=ne(()=>{const{size:y}=_,{common:{cubicBezierEaseInOut:o},self:{groupLabelColor:p,borderRadius:R,groupLabelTextColor:n,lineHeight:x,groupLabelBorder:O,[ue("fontSize",y)]:L,[ue("height",y)]:C}}=u.value;return{"--n-bezier":o,"--n-group-label-color":p,"--n-group-label-border":O,"--n-border-radius":R,"--n-group-label-text-color":n,"--n-font-size":L,"--n-line-height":x,"--n-height":C}}),c=b?De("input-group-label",ne(()=>_.size[0]),m,_):void 0;return{mergedClsPrefix:r,mergedBordered:v,cssVars:b?void 0:m,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender}},render(){var _,v,r;const{mergedClsPrefix:b}=this;return(_=this.onRender)===null||_===void 0||_.call(this),pe("div",{class:[`${b}-input-group-label`,this.themeClass],style:this.cssVars},(r=(v=this.$slots).default)===null||r===void 0?void 0:r.call(v),this.mergedBordered?pe("div",{class:`${b}-input-group-label__border`}):null)}}),va=D({name:"TriggerType",__name:"trigger-type",emits:["update:value"],setup(_,{emit:v}){const r=v,b=A(),u=m=>{r("update:value",m)};return(m,c)=>{const y=Y;return N(),I(y,{value:b.value,"onUpdate:value":[c[0]||(c[0]=o=>b.value=o),u],placeholder:e(a)("common.triggerType.form"),options:e(Q)(e(Ue)),clearable:""},null,8,["value","placeholder","options"])}}}),Ta=D({name:"BlockStrategy",__name:"block-strategy",emits:["update:value"],setup(_,{emit:v}){const r=A(),b=v,u=m=>{b("update:value",m)};return(m,c)=>{const y=Y;return N(),I(y,{value:r.value,"onUpdate:value":[c[0]||(c[0]=o=>r.value=o),u],placeholder:e(a)("common.blockStrategy.form"),options:e(Q)(e(Ve)),clearable:""},null,8,["value","placeholder","options"])}}}),ka=D({name:"TriggerStrategy",__name:"executor-type",emits:["update:value"],setup(_,{emit:v}){const r=A(),b=v,u=m=>{b("update:value",m)};return(m,c)=>{const y=Y;return N(),I(y,{value:r.value,"onUpdate:value":[c[0]||(c[0]=o=>r.value=o),u],placeholder:e(a)("common.executorType.form"),options:e(Q)(e(Ce)),clearable:""},null,8,["value","placeholder","options"])}}}),ha=D({name:"TaskType",__name:"task-type",emits:["update:value"],setup(_,{emit:v}){const r=v,b=A(),u=m=>{r("update:value",m)};return(m,c)=>{const y=Y;return N(),I(y,{value:b.value,"onUpdate:value":[c[0]||(c[0]=o=>b.value=o),u],placeholder:e(a)("common.routeKey.routeForm"),options:e(Q)(e(ze)),clearable:""},null,8,["value","placeholder","options"])}}}),ja=D({name:"JobTriggerInterval",__name:"job-trigger-interval",props:W({triggerType:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const v=oe(_,"modelValue"),r=_,b=fe(),u=A(60),m=A("* * * * * ?");return ee(u,c=>{r.triggerType===2&&(v.value=`${c}`)},{immediate:!0}),ee(m,c=>{r.triggerType===3&&(v.value=c)},{immediate:!0}),ee(()=>r.triggerType,c=>{c===2?v.value=`${u.value}`:c===3?v.value=m.value:v.value="*"},{immediate:!0}),(c,y)=>{const o=ye,p=_a,R=Be,n=se;return N(),te("div",null,[c.triggerType===2?(N(),I(R,{key:0},{default:l(()=>[t(o,{value:u.value,"onUpdate:value":y[0]||(y[0]=x=>u.value=x),placeholder:c.$t("page.jobTask.form.triggerInterval")},null,8,["value","placeholder"]),t(p,null,{default:l(()=>[j("秒")]),_:1})]),_:1})):c.triggerType===3?(N(),I(e(sa),{key:1,modelValue:m.value,"onUpdate:modelValue":y[1]||(y[1]=x=>m.value=x),placeholder:c.$t("page.jobTask.form.triggerInterval_CRON"),lang:e(b).locale},null,8,["modelValue","placeholder","lang"])):c.triggerType===99?(N(),I(n,{key:2,disabled:""})):Oe("",!0)])}}}),Sa=D({name:"JobTaskOperateDrawer",__name:"job-task-operate-drawer",props:W({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:W(["submitted"],["update:visible"]),setup(_,{emit:v}){const r=_,b=v,u=oe(_,"visible"),m=ie({args:[{arg:""}]}),{formRef:c,validate:y,restoreValidation:o}=oa(),{defaultRequiredRule:p}=la(),R=ne(()=>({add:a("page.jobTask.addJobTask"),edit:a("page.jobTask.editJobTask")})[r.operateType]),n=ie(x());function x(){return{groupName:"",jobName:"",argsStr:"",argsType:1,jobStatus:1,routeKey:1,executorType:1,triggerType:2,executorInfo:"",triggerInterval:"60",blockStrategy:1,executorTimeout:60,maxRetryTimes:3,retryInterval:1,taskType:1,parallelNum:1,description:""}}const O={groupName:p,jobName:p,argsType:p,jobStatus:p,routeKey:p,executorType:p,executorInfo:p,triggerType:p,triggerInterval:p,blockStrategy:p,executorTimeout:p,maxRetryTimes:p,retryInterval:p,taskType:p,parallelNum:p};function L(){if(r.operateType==="add"){Object.assign(n,x());return}r.operateType==="edit"&&r.rowData&&(Object.assign(n,r.rowData),n.taskType===3&&n.argsStr&&Object.assign(m,{args:JSON.parse(n.argsStr).map(w=>({arg:w}))}))}function C(){u.value=!1}async function X(){var w,i;if(await y(),r.operateType==="add"){const{groupName:$,jobName:T,argsType:B,jobStatus:K,routeKey:d,executorType:g,executorInfo:f,triggerType:k,triggerInterval:U,blockStrategy:h,executorTimeout:G,maxRetryTimes:E,retryInterval:z,taskType:q,parallelNum:s,description:V}=n,{error:P}=await Le({groupName:$,jobName:T,argsStr:Z(),argsType:B,jobStatus:K,routeKey:d,executorType:g,executorInfo:f,triggerType:k,triggerInterval:U,blockStrategy:h,executorTimeout:G,maxRetryTimes:E,retryInterval:z,taskType:q,parallelNum:s,description:V});if(P)return;(w=window.$message)==null||w.success(a("common.addSuccess"))}if(r.operateType==="edit"){const{id:$,groupName:T,jobName:B,argsType:K,jobStatus:d,routeKey:g,executorType:f,executorInfo:k,triggerType:U,triggerInterval:h,blockStrategy:G,executorTimeout:E,maxRetryTimes:z,retryInterval:q,taskType:s,parallelNum:V,description:P}=n,{error:Ne}=await Ge({id:$,groupName:T,jobName:B,argsStr:Z(),argsType:K,jobStatus:d,routeKey:g,executorType:f,executorInfo:k,triggerType:U,triggerInterval:h,blockStrategy:G,executorTimeout:E,maxRetryTimes:z,retryInterval:q,taskType:s,parallelNum:V,description:P});if(Ne)return;(i=window.$message)==null||i.success(a("common.updateSuccess"))}C(),b("submitted")}function Z(){return n.taskType===3&&m.args?JSON.stringify(m.args.map(w=>w.arg)):n.argsStr}const le=w=>{m.args.splice(w,1)},re=()=>{m.args.push({arg:""})};return ee(u,()=>{u.value&&(L(),o())}),(w,i)=>{const $=se,T=ra,B=je,K=da,d=pa,g=ia,f=Ye,k=M,U=Qe,h=ve,G=Ta,E=va,z=ye,q=na;return N(),I(Se,{modelValue:u.value,"onUpdate:modelValue":i[17]||(i[17]=s=>u.value=s),title:R.value,onHandleSubmit:X},{footer:l(()=>[t(d,{size:16},{default:l(()=>[t(k,{onClick:C},{default:l(()=>[j(S(e(a)("common.cancel")),1)]),_:1}),t(k,{type:"primary",onClick:X},{default:l(()=>[j(S(e(a)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[t(q,{ref_key:"formRef",ref:c,model:n,rules:O},{default:l(()=>[t(T,{label:e(a)("page.jobTask.jobName"),path:"jobName"},{default:l(()=>[t($,{value:n.jobName,"onUpdate:value":i[0]||(i[0]=s=>n.jobName=s),maxlength:64,"show-count":"",placeholder:e(a)("page.jobTask.form.jobName")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.groupName"),path:"groupName"},{default:l(()=>[t(B,{value:n.groupName,"onUpdate:value":i[1]||(i[1]=s=>n.groupName=s)},null,8,["value"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.jobStatus"),path:"jobStatus"},{default:l(()=>[t(g,{value:n.jobStatus,"onUpdate:value":i[2]||(i[2]=s=>n.jobStatus=s),name:"jobStatus"},{default:l(()=>[t(d,null,{default:l(()=>[(N(!0),te(me,null,de(e(_e),s=>(N(),I(K,{key:s.value,value:s.value,label:e(a)(s.label)},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.executorType"),path:"executorType"},{default:l(()=>[t(ka,{value:n.executorType,"onUpdate:value":i[3]||(i[3]=s=>n.executorType=s)},null,8,["value"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.executorInfo"),path:"executorInfo"},{default:l(()=>[t($,{value:n.executorInfo,"onUpdate:value":i[4]||(i[4]=s=>n.executorInfo=s),placeholder:e(a)("page.jobTask.form.executorInfo")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.taskType"),path:"taskType"},{default:l(()=>[t(ha,{value:n.taskType,"onUpdate:value":i[5]||(i[5]=s=>n.taskType=s),placeholder:e(a)("page.jobTask.form.taskType")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.argsStr"),path:"argsStr",rule:n.taskType===3?e(p):void 0},{default:l(()=>[n.taskType===3?(N(),I(h,{key:0,class:"flex-col"},{default:l(()=>[(N(!0),te(me,null,de(m.args,(s,V)=>(N(),I(T,{key:V,label:`分片参数 ${V+1}`,path:`args[${V}].arg`,"show-feedback":!1,class:"m-b-12px",rule:{required:!0,message:`${e(a)("page.jobTask.form.argsStr")} ${V+1}`,trigger:["input","blur"],validator(){return!!s.arg}}},{default:l(()=>[t(ge,{modelValue:s.arg,"onUpdate:modelValue":P=>s.arg=P,lang:"json",placeholder:e(a)("page.jobTask.form.argsStr")},null,8,["modelValue","onUpdate:modelValue","placeholder"]),t(k,{class:"ml-12px",type:"error",dashed:"",onClick:P=>le(V)},{default:l(()=>[t(f,{class:"text-icon"})]),_:2},1032,["onClick"])]),_:2},1032,["label","path","rule"]))),128)),t(k,{block:"",dashed:"","attr-type":"button",onClick:re},{default:l(()=>[t(U,{class:"text-icon"})]),_:1})]),_:1})):(N(),I(ge,{key:1,modelValue:n.argsStr,"onUpdate:modelValue":i[6]||(i[6]=s=>n.argsStr=s),lang:"json",placeholder:e(a)("page.jobTask.form.argsStr")},null,8,["modelValue","placeholder"]))]),_:1},8,["label","rule"]),t(T,{label:e(a)("page.jobTask.routeKey"),path:"routeKey"},{default:l(()=>[t(ua,{value:n.routeKey,"onUpdate:value":i[7]||(i[7]=s=>n.routeKey=s),"task-type":n.taskType},null,8,["value","task-type"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.blockStrategy"),path:"blockStrategy"},{default:l(()=>[t(G,{value:n.blockStrategy,"onUpdate:value":i[8]||(i[8]=s=>n.blockStrategy=s)},null,8,["value"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.triggerType"),path:"triggerType"},{default:l(()=>[t(E,{value:n.triggerType,"onUpdate:value":[i[9]||(i[9]=s=>n.triggerType=s),i[10]||(i[10]=s=>n.triggerInterval="")],placeholder:e(a)("page.jobTask.form.triggerType")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.triggerInterval"),path:"triggerInterval"},{default:l(()=>[t(ja,{modelValue:n.triggerInterval,"onUpdate:modelValue":i[11]||(i[11]=s=>n.triggerInterval=s),"trigger-type":n.triggerType},null,8,["modelValue","trigger-type"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.executorTimeout"),path:"executorTimeout"},{default:l(()=>[t(z,{value:n.executorTimeout,"onUpdate:value":i[12]||(i[12]=s=>n.executorTimeout=s),min:1,max:60,placeholder:e(a)("page.jobTask.form.executorTimeout"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.maxRetryTimes"),path:"maxRetryTimes"},{default:l(()=>[t(z,{value:n.maxRetryTimes,"onUpdate:value":i[13]||(i[13]=s=>n.maxRetryTimes=s),min:1,max:60,placeholder:e(a)("page.jobTask.form.maxRetryTimes"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.retryInterval"),path:"retryInterval"},{default:l(()=>[t(z,{value:n.retryInterval,"onUpdate:value":i[14]||(i[14]=s=>n.retryInterval=s),min:1,max:60,placeholder:e(a)("page.jobTask.form.retryInterval"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.parallelNum"),path:"parallelNum"},{default:l(()=>[t(z,{value:n.parallelNum,"onUpdate:value":i[15]||(i[15]=s=>n.parallelNum=s),min:1,max:60,placeholder:e(a)("page.jobTask.form.parallelNum"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(T,{label:e(a)("page.jobTask.description"),path:"description"},{default:l(()=>[t($,{value:n.description,"onUpdate:value":i[16]||(i[16]=s=>n.description=s),type:"textarea",placeholder:e(a)("page.jobTask.form.description")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Na=D({name:"JobTaskSearch",__name:"job-task-search",props:{model:{required:!0},modelModifiers:{}},emits:W(["reset","search"],["update:model"]),setup(_,{emit:v}){const r=v,b=oe(_,"model");function u(){r("reset")}function m(){r("search")}return(c,y)=>{const o=Xe,p=se,R=Y,n=ca;return N(),I(n,{model:b.value,onSearch:m,onReset:u},{default:l(()=>[t(o,{span:"24 s:12 m:6",label:e(a)("page.jobTask.groupName"),path:"groupName",class:"pr-24px"},{default:l(()=>[t(je,{value:b.value.groupName,"onUpdate:value":y[0]||(y[0]=x=>b.value.groupName=x)},null,8,["value"])]),_:1},8,["label"]),t(o,{span:"24 s:12 m:6",label:e(a)("page.jobTask.jobName"),path:"jobName",class:"pr-24px"},{default:l(()=>[t(p,{value:b.value.jobName,"onUpdate:value":y[1]||(y[1]=x=>b.value.jobName=x),placeholder:e(a)("page.jobTask.form.jobName")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(o,{span:"24 s:12 m:6",label:e(a)("page.jobTask.jobStatus"),path:"jobStatus",class:"pr-24px"},{default:l(()=>[t(R,{value:b.value.jobStatus,"onUpdate:value":y[2]||(y[2]=x=>b.value.jobStatus=x),placeholder:e(a)("page.jobTask.form.jobStatus"),options:e(Q)(e(_e))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),xa=D({name:"JobTaskDetailDrawer",__name:"job-task-detail-drawer",props:W({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(_){const v=oe(_,"visible");return(r,b)=>{const u=ga,m=ae,c=ba,y=Se;return N(),I(y,{modelValue:v.value,"onUpdate:modelValue":b[0]||(b[0]=o=>v.value=o),title:e(a)("page.jobTask.detail")},{default:l(()=>[t(c,{"label-placement":"top",bordered:"",column:2},{default:l(()=>[t(u,{label:e(a)("page.jobTask.groupName")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.groupName),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.jobName")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.jobName),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.taskType")},{default:l(()=>{var o;return[t(m,{type:e(F)((o=r.rowData)==null?void 0:o.taskType)},{default:l(()=>{var p;return[j(S(e(a)(e(Te)[(p=r.rowData)==null?void 0:p.taskType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.argsStr")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.argsStr),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.nextTriggerAt")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.nextTriggerAt),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.jobStatus")},{default:l(()=>{var o;return[t(m,{type:e(F)((o=r.rowData)==null?void 0:o.jobStatus)},{default:l(()=>{var p;return[j(S(e(a)(e(Ke)[(p=r.rowData)==null?void 0:p.jobStatus])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.routeKey")},{default:l(()=>{var o;return[t(m,{type:e(F)((o=r.rowData)==null?void 0:o.routeKey)},{default:l(()=>{var p;return[j(S(e(a)(e(Je)[(p=r.rowData)==null?void 0:p.routeKey])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.executorType")},{default:l(()=>{var o;return[t(m,{type:e(F)((o=r.rowData)==null?void 0:o.executorType)},{default:l(()=>{var p;return[j(S(e(a)(e(Ae)[(p=r.rowData)==null?void 0:p.executorType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.executorInfo")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.executorInfo),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.triggerType")},{default:l(()=>{var o;return[t(m,{type:e(F)((o=r.rowData)==null?void 0:o.triggerType)},{default:l(()=>{var p;return[j(S(e(a)(e(ke)[(p=r.rowData)==null?void 0:p.triggerType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.triggerInterval")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.triggerInterval),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.blockStrategy")},{default:l(()=>{var o;return[t(m,{type:e(F)((o=r.rowData)==null?void 0:o.blockStrategy)},{default:l(()=>{var p;return[j(S(e(a)(e(he)[(p=r.rowData)==null?void 0:p.blockStrategy])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.executorTimeout")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.executorTimeout),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.maxRetryTimes")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.maxRetryTimes),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.retryInterval")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.retryInterval),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.parallelNum")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.parallelNum),1)]}),_:1},8,["label"]),t(u,{label:e(a)("page.jobTask.description"),span:2},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.description),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue","title"])}}}),wa={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function J(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!Me(_)}const Ea=D({name:"job_task",__name:"index",setup(_){const{hasAuth:v}=ta(),r=fe(),{routerPushByKey:b}=Pe(),u=A(),{bool:m,setTrue:c}=Fe(!1),{columnChecks:y,columns:o,data:p,getData:R,loading:n,mobilePagination:x,searchParams:O,resetSearchParams:L}=Ze({apiFn:Ee,apiParams:{page:1,size:10,groupName:null,jobName:null,jobStatus:null},columns:()=>[{key:"index",title:a("common.index"),align:"center",width:40},{key:"jobName",title:a("page.jobTask.jobName"),align:"center",width:140,fixed:"left",render:d=>{async function g(){u.value=d,c()}return t(M,{text:!0,tag:"a",type:"primary",onClick:g,class:"ws-normal"},{default:()=>[d.jobName]})}},{key:"groupName",title:a("page.jobTask.groupName"),align:"left",width:180},{key:"nextTriggerAt",title:a("page.jobTask.nextTriggerAt"),align:"center",width:120},{key:"jobStatus",title:a("page.jobTask.jobStatus"),align:"center",width:60,render:d=>{const g=async(f,k)=>{var h;const{error:U}=await We({id:d.id,jobStatus:f});U||(d.jobStatus=f,(h=window.$message)==null||h.success(a("common.updateSuccess"))),k()};return t(aa,{value:d.jobStatus,"onUpdate:value":f=>d.jobStatus=f,onFetch:g},null)}},{key:"taskType",title:a("page.jobTask.taskType"),align:"center",width:120,render:d=>{if(d.taskType===null)return null;const g={1:"info",2:"success",3:"error"},f=a(Te[d.taskType]);return t(ae,{type:g[d.taskType]},J(f)?f:{default:()=>[f]})}},{key:"triggerType",title:a("page.jobTask.triggerType"),align:"center",width:120,render:d=>{if(d.triggerType===null)return null;const g={2:"info",3:"success",99:"error"},f=a(ke[d.triggerType]);return t(ae,{type:g[d.triggerType]},J(f)?f:{default:()=>[f]})}},{key:"triggerInterval",title:a("page.jobTask.triggerInterval"),align:"center",width:80},{key:"blockStrategy",title:a("page.jobTask.blockStrategy"),align:"center",width:80,render:d=>{if(d.blockStrategy===null)return null;const g={1:"info",2:"success",3:"error"},f=a(he[d.blockStrategy]);return t(ae,{type:g[d.blockStrategy]},J(f)?f:{default:()=>[f]})}},{key:"executorTimeout",title:a("page.jobTask.executorTimeout"),align:"center",width:80},{key:"updateDt",title:a("page.jobTask.updateDt"),align:"center",width:120},{key:"operate",title:a("common.operate"),align:"center",width:180,fixed:"right",render:d=>{let g,f;return t("div",{class:"flex-center gap-8px"},[t(ce,{onPositiveClick:()=>B(d.id)},{default:()=>a("common.confirmExecute"),trigger:()=>{let k;return t(M,{type:"error",ghost:!0,size:"small"},J(k=a("common.execute"))?k:{default:()=>[k]})}}),t(M,{type:"primary",ghost:!0,size:"small",onClick:()=>K(d.id)},J(g=a("common.batchList"))?g:{default:()=>[g]}),t(M,{type:"warning",ghost:!0,size:"small",onClick:()=>T(d.id)},J(f=a("common.edit"))?f:{default:()=>[f]}),v("R_ADMIN")?t(ce,{onPositiveClick:()=>$(d.id)},{default:()=>a("common.confirmDelete"),trigger:()=>{let k;return t(M,{type:"error",ghost:!0,size:"small"},J(k=a("common.delete"))?k:{default:()=>[k]})}}):""])}}]}),{drawerVisible:C,operateType:X,editingData:Z,handleAdd:le,handleEdit:re,checkedRowKeys:w,onDeleted:i}=ea(p,R);async function $(d){const{error:g}=await qe(d);g||i()}function T(d){re(d)}async function B(d){var f,k;const{error:g}=await He(d);g?(f=window.$message)==null||f.error(a("common.executeFailed")):(k=window.$message)==null||k.success(a("common.executeSuccess"))}function K(d){b("job_batch",{query:{jobId:d}})}return(d,g)=>{const f=xe,k=ma,U=ve;return N(),te("div",wa,[t(Na,{model:e(O),"onUpdate:model":g[0]||(g[0]=h=>H(O)?O.value=h:null),onReset:e(L),onSearch:e(R)},null,8,["model","onReset","onSearch"]),t(U,{title:e(a)("page.jobTask.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":l(()=>[t(f,{columns:e(y),"onUpdate:columns":g[1]||(g[1]=h=>H(y)?y.value=h:null),loading:e(n),"show-delete":!1,onAdd:e(le),onRefresh:e(R)},null,8,["columns","loading","onAdd","onRefresh"])]),default:l(()=>[t(k,{"checked-row-keys":e(w),"onUpdate:checkedRowKeys":g[2]||(g[2]=h=>H(w)?w.value=h:null),columns:e(o),data:e(p),"flex-height":!e(r).isMobile,"scroll-x":2e3,loading:e(n),remote:"","row-key":h=>h.id,pagination:e(x),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"]),t(Sa,{visible:e(C),"onUpdate:visible":g[3]||(g[3]=h=>H(C)?C.value=h:null),"operate-type":e(X),"row-data":e(Z),onSubmitted:e(R)},null,8,["visible","operate-type","row-data","onSubmitted"]),t(xa,{visible:e(m),"onUpdate:visible":g[4]||(g[4]=h=>H(m)?m.value=h:null),"row-data":u.value},null,8,["visible","row-data"])])}}});export{Ea as default};
