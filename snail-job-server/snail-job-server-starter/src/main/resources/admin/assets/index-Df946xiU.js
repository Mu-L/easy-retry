import{_ as O}from"./table-header-operation.vue_vue_type_script_setup_true_lang-ntuddL0e.js";import{d as D,U as T,p as q,V as z,o as I,c as j,w as p,f as l,h as t,$ as a,a3 as F,bb as G,J as L,s as V,b as K,a9 as y,bl as E,N as R,bm as H,B as W,aO as J,dI as Q,I as X,aa as Y}from"./index-DQvTTbM-.js";import{f as Z,a as ee,b as te}from"./workflow-CUJIz2-V.js";import{_ as ae,u as oe,a as le,N as ne}from"./table-BY-eM7wn.js";import{_ as se}from"./search-form.vue_vue_type_script_setup_true_lang-gb65EZBS.js";import{_ as re}from"./select-group.vue_vue_type_script_setup_true_lang-BFflBQVF.js";import{_ as ie}from"./task-batch-status.vue_vue_type_script_setup_true_lang-KC0ydVlx.js";import{b as ce}from"./Grid-CSTnYjse.js";import"./Space-B5Upi9VN.js";import"./form-Bu4MD_Ly.js";import"./round-search-DSNvd4Y0.js";import"./group-DKztxFm0.js";const ue=D({name:"WorkflowBatchSearch",__name:"workflow-batch-search",props:{model:{required:!0},modelModifiers:{}},emits:T(["reset","search"],["update:model"]),setup(m,{emit:B}){const d=B,_=q([]),r=z(m,"model");function v(){d("reset")}function f(){d("search")}async function h(i){const s=await Z({groupName:i});_.value=s.data}return h(""),(i,s)=>{const w=ae,k=F,S=se;return I(),j(S,{model:r.value,onSearch:f,onReset:v},{default:p(()=>[l(w,{span:"24 s:12 m:6",label:t(a)("page.workflowBatch.groupName"),path:"groupName",class:"pr-24px"},{default:p(()=>[l(re,{value:r.value.groupName,"onUpdate:value":[s[0]||(s[0]=c=>r.value.groupName=c),h]},null,8,["value"])]),_:1},8,["label"]),l(w,{span:"24 s:12 m:6",label:t(a)("page.workflowBatch.workflowName"),"label-width":100,path:"workflowName",class:"pr-24px"},{default:p(()=>[l(k,{value:r.value.workflowId,"onUpdate:value":s[1]||(s[1]=c=>r.value.workflowId=c),placeholder:t(a)("page.workflowBatch.form.workflowName"),"value-field":"id","label-field":"workflowName",options:_.value,clearable:"",filterable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),l(w,{span:"24 s:12 m:6",label:t(a)("page.workflowBatch.taskBatchStatus"),path:"taskBatchStatus",class:"pr-24px"},{default:p(()=>[l(ie,{value:r.value.taskBatchStatus,"onUpdate:value":s[2]||(s[2]=c=>r.value.taskBatchStatus=c)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),me={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function b(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!Y(m)}const ye=D({name:"workflow_batch",__name:"index",setup(m){var N,x;const B=G(),d=L(),_=((N=d.query)==null?void 0:N.workflowId)===void 0?null:Number.parseInt((x=d.query)==null?void 0:x.workflowId,10),r=V(),{columns:v,columnChecks:f,data:h,getData:i,loading:s,mobilePagination:w,searchParams:k,resetSearchParams:S}=oe({apiFn:ee,apiParams:{page:1,size:10,workflowId:_,groupName:null,taskBatchStatus:null},columns:()=>[{key:"index",title:a("common.index"),align:"center",width:64},{key:"workflowName",title:a("page.workflowBatch.workflowName"),align:"left",minWidth:120},{key:"groupName",title:a("page.workflowBatch.groupName"),align:"left",minWidth:120},{key:"executionAt",title:a("page.workflowBatch.executionAt"),align:"left",minWidth:120},{key:"taskBatchStatus",title:a("page.workflowBatch.taskBatchStatus"),align:"left",minWidth:120,render:e=>{if(!e.taskBatchStatus)return null;const o={1:"info",2:"success",3:"success",4:"error",5:"warning",6:"warning"},n=a(E[e.taskBatchStatus]);return l(R,{type:o[e.taskBatchStatus]},b(n)?n:{default:()=>[n]})}},{key:"operationReason",title:a("page.workflowBatch.operationReason"),align:"left",minWidth:120,render:e=>{if(!e.operationReason)return null;const o=a(H[e.operationReason]);return l(R,{type:"warning"},b(o)?o:{default:()=>[o]})}},{key:"createDt",title:a("page.workflowBatch.createDt"),align:"left",minWidth:120},{key:"operate",title:a("common.operate"),align:"center",width:130,render:e=>{let o;return l("div",{class:"flex-center gap-8px"},[l(W,{type:"primary",ghost:!0,size:"small",onClick:()=>C(e.id)},b(o=a("common.detail"))?o:{default:()=>[o]}),(e==null?void 0:e.taskBatchStatus)===1||(e==null?void 0:e.taskBatchStatus)===2?J(l(ne,{onPositiveClick:()=>A(e.id)},{default:()=>a("common.confirmStop"),trigger:()=>{let n;return l(W,{type:"error",ghost:!0,size:"small"},b(n=a("common.stop"))?n:{default:()=>[n]})}}),[[Q("if"),""]]):""])}}]}),{handleAdd:c,checkedRowKeys:g,onBatchDeleted:$}=le(h,i);async function U(){console.log(g.value),$()}async function A(e){var n;const{error:o}=await te(e);o||((n=window.$message)==null||n.success(a("common.executeSuccess")),i())}function C(e){B.push({path:"/workflow/form/batch",query:{id:e}})}return(e,o)=>{const n=O,P=ce,M=X;return I(),K("div",me,[l(ue,{model:t(k),"onUpdate:model":o[0]||(o[0]=u=>y(k)?k.value=u:null),onReset:t(S),onSearch:t(i)},null,8,["model","onReset","onSearch"]),l(M,{title:t(a)("page.workflowBatch.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":p(()=>[l(n,{columns:t(f),"onUpdate:columns":o[1]||(o[1]=u=>y(f)?f.value=u:null),"disabled-delete":t(g).length===0,loading:t(s),"show-delete":!1,onAdd:t(c),onDelete:U,onRefresh:t(i)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:p(()=>[l(P,{"checked-row-keys":t(g),"onUpdate:checkedRowKeys":o[2]||(o[2]=u=>y(g)?g.value=u:null),columns:t(v),data:t(h),"flex-height":!t(r).isMobile,"scroll-x":962,loading:t(s),remote:"","row-key":u=>u.id,pagination:t(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{ye as default};
