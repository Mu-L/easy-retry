import{_ as de,u as ge,a as ce,N as me,b as fe}from"./table-Bdl3-G-Y.js";import{d as _e,_ as be,a as ve}from"./download-Cm66Rkpl.js";import{d as j,U as B,V as Q,a as he,$ as t,p as X,r as Se,W as ee,o as P,c as U,w as a,f as o,g as y,t as N,h as e,b as q,Q as J,R as H,X as oe,Y as te,Z as Ce,a0 as ye,a1 as Ne,n as ae,a2 as we,a3 as ke,B as A,a4 as De,O as Ge,a5 as Me,a6 as ne,a7 as Re,a8 as F,a9 as xe,aa as le,ab as re,N as K,s as Pe,ac as Te,ad as O,S as Ue,I as $e,ae as Oe}from"./index-CHgAHQIl.js";import{f as Ie,a as Ve,b as Ae,c as Fe,d as Be}from"./group-BUALrrKR.js";import{_ as je}from"./status-switch.vue_vue_type_script_setup_true_lang-DFxhp7sV.js";import{u as Ee}from"./auth-uwVlWSMM.js";import{_ as ie}from"./operate-drawer-3XJn0MkC.js";import{_ as ze}from"./round-search-KK91k1IY.js";import{u as We,a as Le}from"./form-BuwwOwyC.js";import{_ as qe,a as Je}from"./FormItem-B3tfy17D.js";import{_ as Ke}from"./Space-CeVCCXQI.js";import{_ as Qe,a as Ye}from"./DescriptionsItem-sCQ7QkHp.js";import{_ as Ze}from"./search-form.vue_vue_type_script_setup_true_lang-BfZ4by1v.js";import{_ as He}from"./Grid-DHGKk79k.js";import"./Progress-Ba5RQgAV.js";import"./close-fullscreen-rounded-DtEdfPev.js";const Xe=j({name:"GroupOperateDrawer",__name:"group-operate-drawer",props:B({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:B(["submitted"],["update:visible"]),setup(v,{emit:w}){const d=v,s=w,c=Q(v,"visible"),{formRef:m,validate:T,restoreValidation:h}=We(),{defaultRequiredRule:f}=Le(),r=he(()=>({add:t("page.groupConfig.addGroupConfig"),edit:t("page.groupConfig.editGroupConfig")})[d.operateType]),g=X([]),u=Se(S());function S(){return{groupName:"",token:"SJ_Wyz3dmsdbDOkDujOTSSoBjGQP1BMsVnj",groupStatus:1,description:"",idGeneratorMode:2,initScene:1,groupPartition:0}}const E={groupName:[f,{required:!0,pattern:/^[A-Za-z0-9_-]{1,64}$/,trigger:"change",message:t("page.groupConfig.form.groupNameRule")}],token:[f],groupStatus:[f],idGeneratorMode:[f],initScene:[f],groupPartition:[f]};function $(){if(d.operateType==="add"){Object.assign(u,S());return}d.operateType==="edit"&&d.rowData&&Object.assign(u,d.rowData)}function I(){c.value=!1}async function V(){var G,i;if(await T(),d.operateType==="add"){const{groupName:C,token:l,groupStatus:n,description:_,idGeneratorMode:M,initScene:x,groupPartition:k}=u,{error:R}=await Ie({groupName:C,token:l,groupStatus:n,description:_,idGeneratorMode:M,initScene:x,groupPartition:k});if(R)return;(G=window.$message)==null||G.success(t("common.addSuccess"))}else{const{groupName:C,token:l,groupStatus:n,description:_,idGeneratorMode:M,initScene:x,groupPartition:k}=u,{error:R}=await Ve({groupName:C,token:l,groupStatus:n,description:_,idGeneratorMode:M,initScene:x,groupPartition:k});if(R)return;(i=window.$message)==null||i.success(t("common.updateSuccess"))}I(),s("submitted")}function z(){u.token=W(32)}function W(G){const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let C="SJ_";for(let l=0;l<G;l+=1){const n=Math.floor(Math.random()*i.length);C+=i.substring(n,n+1)}return C}const D=async()=>{const{data:G}=await Ae();g.value=G.map(i=>String(i))};return ee(c,()=>{c.value&&(D(),$(),h())}),(G,i)=>{const C=ae,l=qe,n=we,_=Ke,M=ke,x=ze,k=A,R=De,b=Ge,Y=Me,Z=ne,ue=Re,pe=Je,se=ie;return P(),U(se,{modelValue:c.value,"onUpdate:modelValue":i[7]||(i[7]=p=>c.value=p),title:r.value,onSubmitted:V},{footer:a(()=>[o(_,{size:16},{default:a(()=>[o(k,{onClick:I},{default:a(()=>[y(N(e(t)("common.cancel")),1)]),_:1}),o(k,{type:"primary",onClick:V},{default:a(()=>[y(N(e(t)("common.save")),1)]),_:1})]),_:1})]),default:a(()=>[o(pe,{ref_key:"formRef",ref:m,model:u,rules:E},{default:a(()=>[o(ue,{"default-expanded-names":["1","2"]},{default:a(()=>[o(Y,{title:e(t)("page.groupConfig.commonConfig"),name:"1"},{default:a(()=>[o(l,{label:e(t)("page.groupConfig.groupName"),path:"groupName"},{default:a(()=>[o(C,{value:u.groupName,"onUpdate:value":i[0]||(i[0]=p=>u.groupName=p),maxlength:64,"show-count":"",placeholder:e(t)("page.groupConfig.form.groupName"),disabled:d.operateType==="edit"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),o(l,{label:e(t)("page.groupConfig.groupStatus"),path:"groupStatus"},{default:a(()=>[o(M,{value:u.groupStatus,"onUpdate:value":i[1]||(i[1]=p=>u.groupStatus=p),name:"groupStatus"},{default:a(()=>[o(_,null,{default:a(()=>[(P(!0),q(J,null,H(e(oe),p=>(P(),U(n,{key:p.value,value:p.value,label:e(t)(p.label)},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),o(l,{label:e(t)("page.groupConfig.token"),path:"token"},{default:a(()=>[o(b,null,{default:a(()=>[o(C,{value:u.token,"onUpdate:value":i[2]||(i[2]=p=>u.token=p),maxlength:64,placeholder:e(t)("page.groupConfig.form.token"),disabled:d.operateType==="edit"},null,8,["value","placeholder","disabled"]),o(R,{trigger:"hover"},{trigger:a(()=>[o(k,{type:"default",ghost:"",disabled:d.operateType==="edit",onClick:z},{default:a(()=>[o(x,{class:"text-icon"})]),_:1},8,["disabled"])]),default:a(()=>[y(" "+N(e(t)("page.groupConfig.generateToken")),1)]),_:1})]),_:1})]),_:1},8,["label"]),o(l,{label:e(t)("page.groupConfig.description"),path:"description"},{default:a(()=>[o(C,{value:u.description,"onUpdate:value":i[3]||(i[3]=p=>u.description=p),type:"textarea",maxlength:256,"show-count":"",placeholder:e(t)("page.groupConfig.form.description"),clearable:"",round:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["title"]),o(Y,{title:e(t)("page.groupConfig.retryConfig"),name:"2"},{default:a(()=>[o(l,{label:e(t)("page.groupConfig.idGeneratorMode"),path:"idGeneratorMode"},{default:a(()=>[o(Z,{value:u.idGeneratorMode,"onUpdate:value":i[4]||(i[4]=p=>u.idGeneratorMode=p),placeholder:e(t)("page.groupConfig.form.idGeneratorMode"),options:e(te)(e(Ce))},null,8,["value","placeholder","options"])]),_:1},8,["label"]),o(l,{label:e(t)("page.groupConfig.initScene"),path:"initScene"},{default:a(()=>[o(M,{value:u.initScene,"onUpdate:value":i[5]||(i[5]=p=>u.initScene=p),name:"initScene"},{default:a(()=>[o(_,null,{default:a(()=>[(P(!0),q(J,null,H(e(ye),p=>(P(),U(n,{key:p.value,value:p.value,label:e(t)(p.label)},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),o(l,{label:e(t)("page.groupConfig.groupPartition"),path:"groupPartition"},{default:a(()=>[o(Z,{value:u.groupPartition,"onUpdate:value":i[6]||(i[6]=p=>u.groupPartition=p),placeholder:e(t)("page.groupConfig.form.groupPartition"),options:e(Ne)(g.value)},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["title"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),eo=j({name:"GroupDetailDrawer",__name:"group-detail-drawer",props:B({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(v){const w=v,d=Q(v,"visible");return ee(()=>w.rowData,()=>{console.log(w.rowData)},{immediate:!0}),(s,c)=>{const m=Qe,T=K,h=Ye,f=ie;return P(),U(f,{modelValue:d.value,"onUpdate:modelValue":c[0]||(c[0]=r=>d.value=r),title:e(t)("page.groupConfig.detail")},{default:a(()=>[o(h,{"label-placement":"top",bordered:"",column:2},{default:a(()=>[o(m,{label:e(t)("page.groupConfig.groupName"),span:2},{default:a(()=>{var r;return[y(N((r=s.rowData)==null?void 0:r.groupName),1)]}),_:1},8,["label"]),o(m,{label:e(t)("page.groupConfig.token"),span:2},{default:a(()=>{var r;return[y(N((r=s.rowData)==null?void 0:r.token),1)]}),_:1},8,["label"]),o(m,{label:e(t)("page.groupConfig.groupStatus"),span:1},{default:a(()=>{var r;return[o(T,{type:e(F)((r=s.rowData)==null?void 0:r.groupStatus)},{default:a(()=>{var g;return[y(N(e(t)(e(xe)[(g=s.rowData)==null?void 0:g.groupStatus])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),o(m,{label:e(t)("page.groupConfig.idGeneratorMode"),span:1},{default:a(()=>{var r;return[o(T,{type:e(F)((r=s.rowData)==null?void 0:r.idGeneratorMode)},{default:a(()=>{var g;return[y(N(e(t)(e(le)[(g=s.rowData)==null?void 0:g.idGeneratorMode])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),o(m,{label:e(t)("page.groupConfig.groupPartition"),span:1},{default:a(()=>{var r;return[y(N((r=s.rowData)==null?void 0:r.groupPartition),1)]}),_:1},8,["label"]),o(m,{label:e(t)("page.groupConfig.initScene"),span:1},{default:a(()=>{var r;return[o(T,{type:e(F)((r=s.rowData)==null?void 0:r.initScene)},{default:a(()=>{var g;return[y(N(e(t)(e(re)[(g=s.rowData)==null?void 0:g.initScene])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),o(m,{label:e(t)("page.groupConfig.description"),span:2},{default:a(()=>{var r;return[y(N((r=s.rowData)==null?void 0:r.description),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue","title"])}}}),oo=j({name:"GroupSearch",__name:"group-search",props:{model:{required:!0},modelModifiers:{}},emits:B(["reset","search"],["update:model"]),setup(v,{emit:w}){const d=w,s=Q(v,"model");function c(){d("reset")}function m(){d("search")}return(T,h)=>{const f=ae,r=de,g=ne,u=Ze;return P(),U(u,{model:s.value,onSearch:m,onReset:c},{default:a(()=>[o(r,{span:"24 s:12 m:6",label:e(t)("page.groupConfig.groupName"),path:"groupName",class:"pr-24px"},{default:a(()=>[o(f,{value:s.value.groupName,"onUpdate:value":h[0]||(h[0]=S=>s.value.groupName=S),placeholder:e(t)("page.groupConfig.form.groupName")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(r,{span:"24 s:12 m:6",label:e(t)("page.groupConfig.groupStatus"),path:"groupStatus",class:"pr-24px"},{default:a(()=>[o(g,{value:s.value.groupStatus,"onUpdate:value":h[1]||(h[1]=S=>s.value.groupStatus=S),placeholder:e(t)("page.groupConfig.form.groupStatus"),options:e(te)(e(oe)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),to={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function L(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!Oe(v)}const So=j({name:"group",__name:"index",setup(v){const{hasAuth:w}=Ee(),d=Pe(),s=X(),{bool:c,setTrue:m}=Te(!1),{columns:T,columnChecks:h,data:f,getData:r,loading:g,mobilePagination:u,searchParams:S,resetSearchParams:E}=ge({apiFn:Fe,apiParams:{page:1,size:10,groupName:null,groupStatus:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:t("common.index"),align:"center",width:64},{key:"groupName",title:t("page.groupConfig.groupName"),align:"left",minWidth:260,render:l=>{function n(){s.value=l||null,m()}return o(A,{text:!0,tag:"a",type:"primary",onClick:n,class:"ws-normal"},{default:()=>[l.groupName]})}},{key:"groupStatus",title:t("page.groupConfig.groupStatus"),align:"center",width:80,render:l=>{const n=async(_,M)=>{var R;const x=l.groupStatus===1?0:1,{error:k}=await Be({groupName:l.groupName,groupStatus:x});k||(l.groupStatus=_,(R=window.$message)==null||R.success(t("common.updateSuccess"))),M()};return o(je,{value:l.groupStatus,"onUpdate:value":_=>l.groupStatus=_,onFetch:n},null)}},{key:"idGeneratorMode",title:t("page.groupConfig.idGeneratorMode"),align:"center",width:120,render:l=>{if(l.idGeneratorMode===null)return null;const n=t(le[l.idGeneratorMode]);return o(K,{type:"primary"},L(n)?n:{default:()=>[n]})}},{key:"groupPartition",title:t("page.groupConfig.groupPartition"),align:"center",minWidth:60},{key:"initScene",title:t("page.groupConfig.initScene"),align:"center",minWidth:80,render:l=>{if(l.groupStatus===null)return null;const n=t(re[l.initScene]);return o(K,{type:F(l.initScene)},L(n)?n:{default:()=>[n]})}},{key:"updateDt",title:t("page.groupConfig.updateDt"),align:"left",width:130},{key:"description",title:t("page.groupConfig.description"),align:"left",width:130},{key:"operate",title:t("common.operate"),align:"center",width:130,render:l=>{let n;return w("R_USER")?o(J,null,null):o("div",{class:"flex-center gap-8px"},[o(A,{type:"primary",text:!0,ghost:!0,size:"small",onClick:()=>G(l.id)},L(n=t("common.edit"))?n:{default:()=>[n]})])}}]}),{drawerVisible:$,operateType:I,editingData:V,handleAdd:z,handleEdit:W,checkedRowKeys:D}=ce(f,r);function G(l){W(l)}function i(){return{groupName:S.groupName,groupStatus:S.groupStatus,groupIds:D.value}}function C(){_e("/group/export",i(),t("page.groupConfig.title"))}return(l,n)=>{const _=be,M=ve,x=fe,k=He,R=$e;return P(),q("div",to,[o(oo,{model:e(S),"onUpdate:model":n[0]||(n[0]=b=>O(S)?S.value=b:null),onReset:e(E),onSearch:e(r)},null,8,["model","onReset","onSearch"]),o(R,{title:e(t)("page.groupConfig.title"),bordered:!1,size:"small","header-class":"view-card-header",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":a(()=>[o(x,{columns:e(h),"onUpdate:columns":n[1]||(n[1]=b=>O(h)?h.value=b:null),"disabled-delete":e(D).length===0,loading:e(g),"show-delete":!1,"show-add":e(w)("R_ADMIN"),onAdd:e(z),onRefresh:e(r)},{addAfter:a(()=>[e(w)("R_ADMIN")?(P(),U(_,{key:0,action:"/group/import",accept:"application/json",onRefresh:e(r)},null,8,["onRefresh"])):Ue("",!0),o(e(me),{onPositiveClick:C},{trigger:a(()=>[o(e(A),{size:"small",ghost:"",type:"primary",disabled:e(D).length===0&&e(w)("R_USER")},{icon:a(()=>[o(M,{class:"text-icon"})]),default:a(()=>[y(" "+N(e(t)("common.export")),1)]),_:1},8,["disabled"])]),default:a(()=>[y(N(e(D).length===0?e(t)("common.exportAll"):e(t)("common.exportPar",{num:e(D).length})),1)]),_:1})]),_:1},8,["columns","disabled-delete","loading","show-add","onAdd","onRefresh"])]),default:a(()=>[o(k,{"checked-row-keys":e(D),"onUpdate:checkedRowKeys":n[2]||(n[2]=b=>O(D)?D.value=b:null),columns:e(T),data:e(f),"flex-height":!e(d).isMobile,"scroll-x":962,loading:e(g),remote:"","row-key":b=>b.id,pagination:e(u),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),o(Xe,{visible:e($),"onUpdate:visible":n[3]||(n[3]=b=>O($)?$.value=b:null),"operate-type":e(I),"row-data":e(V),onSubmitted:e(r)},null,8,["visible","operate-type","row-data","onSubmitted"]),o(eo,{visible:e(c),"onUpdate:visible":n[4]||(n[4]=b=>O(c)?c.value=b:null),"row-data":s.value},null,8,["visible","row-data"])]),_:1},8,["title"])])}}});export{So as default};
